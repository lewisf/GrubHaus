(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define(["backbone","handlebars","text!templates/index.html","text!templates/search_result_container.html","text!templates/search_result.html"],function(e,n,r,i,s){var o;return o=function(e){function o(){return o.__super__.constructor.apply(this,arguments)}return t(o,e),o.prototype.query="",o.prototype.events={"submit #search-form":"doSearch"},o.prototype.initialize=function(e){return this.template=n.compile(r),this.resContainerTemplate=n.compile(i),this.searchResultHtml=n.compile(s),this.query=e,this.render(),!1},o.prototype.render=function(){return this.$el.html(this.template({query:this.query})),this.doSearch()},o.prototype.renderResults=function(e){var t=this;return _.isEmpty($("#results-container"))&&$("#wrap-push").append(this.resContainerTemplate),$("#results-list").html(""),_.each(e,function(e){return e.description=e.description.substring(0,150)+"...",$("#results-list").append(t.searchResultHtml(e))})},o.prototype.doSearch=function(e){var t,n,r=this;e!=null&&(e.preventDefault(),this.query=$("input[name=q]").val(),window.router.navigate("recipes/search/"+this.query));if(!_.isEmpty(this.query))return t="/api/recipes/search.json",n=""+t+"?q="+this.query,$.getJSON(n,function(e){return r.renderResults(e),r.updateQueryIndicator(r.query)}),!1},o.prototype.updateQueryIndicator=function(e){return $("span#q-ind").text(e)},o}(e.View)})}).call(this);