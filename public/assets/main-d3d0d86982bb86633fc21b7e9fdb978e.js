/*
 * SimpleModal @VERSION - jQuery Plugin
 * http://simplemodal.com/
 * Copyright (c) 2012 Eric Martin
 * Licensed under MIT and GPL
 * Date:
 */

/**
 * @license RequireJS text 2.0.3 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

(function(factory){typeof define=="function"&&define.amd?define("jquery.simplemodal",["jquery"],factory):factory(jQuery)})(function($){var d=[],doc=$(document),ie6=$.browser.msie&&parseInt($.browser.version)===6&&typeof window.XMLHttpRequest!="object",ie7=$.browser.msie&&parseInt($.browser.version)===7,ieQuirks=null,wndw=$(window),w=[];$.modal=function(data,options){return $.modal.impl.init(data,options)},$.modal.close=function(){$.modal.impl.close()},$.modal.focus=function(pos){$.modal.impl.focus(pos)},$.modal.setContainerDimensions=function(){$.modal.impl.setContainerDimensions()},$.modal.setPosition=function(){$.modal.impl.setPosition()},$.modal.update=function(height,width){$.modal.impl.update(height,width)},$.fn.modal=function(options){return $.modal.impl.init(this,options)},$.modal.defaults={appendTo:"body",focus:!0,opacity:50,overlayId:"simplemodal-overlay",overlayCss:{},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!1,autoPosition:!0,zIndex:1e3,close:!0,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"simplemodal-close",escClose:!0,overlayClose:!1,fixed:!0,position:null,persist:!1,modal:!0,onOpen:null,onShow:null,onClose:null},$.modal.impl={d:{},init:function(data,options){var s=this;if(s.d.data)return!1;ieQuirks=$.browser.msie&&!$.support.boxModel,s.o=$.extend({},$.modal.defaults,options),s.zIndex=s.o.zIndex,s.occb=!1;if(typeof data=="object")data=data instanceof $?data:$(data),s.d.placeholder=!1,data.parent().parent().size()>0&&(data.before($("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"})),s.d.placeholder=!0,s.display=data.css("display"),s.o.persist||(s.d.orig=data.clone(!0)));else{if(typeof data!="string"&&typeof data!="number")return alert("SimpleModal Error: Unsupported data type: "+typeof data),s;data=$("<div></div>").html(data)}return s.create(data),data=null,s.open(),$.isFunction(s.o.onShow)&&s.o.onShow.apply(s,[s.d]),s},create:function(data){var s=this;s.getDimensions(),s.o.modal&&ie6&&(s.d.iframe=$('<iframe src="javascript:false;"></iframe>').css($.extend(s.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:w[0],width:w[1],zIndex:s.o.zIndex,top:0,left:0})).appendTo(s.o.appendTo)),s.d.overlay=$("<div></div>").attr("id",s.o.overlayId).addClass("simplemodal-overlay").css($.extend(s.o.overlayCss,{display:"none",opacity:s.o.opacity/100,height:s.o.modal?d[0]:0,width:s.o.modal?d[1]:0,position:"fixed",left:0,top:0,zIndex:s.o.zIndex+1})).appendTo(s.o.appendTo),s.d.container=$("<div></div>").attr("id",s.o.containerId).addClass("simplemodal-container").css($.extend({position:s.o.fixed?"fixed":"absolute"},s.o.containerCss,{display:"none",zIndex:s.o.zIndex+2})).append(s.o.close&&s.o.closeHTML?$(s.o.closeHTML).addClass(s.o.closeClass):"").appendTo(s.o.appendTo),s.d.wrap=$("<div></div>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(s.d.container),s.d.data=data.attr("id",data.attr("id")||s.o.dataId).addClass("simplemodal-data").css($.extend(s.o.dataCss,{display:"none"})).appendTo("body"),data=null,s.setContainerDimensions(),s.d.data.appendTo(s.d.wrap),(ie6||ieQuirks)&&s.fixIE()},bindEvents:function(){var s=this;$("."+s.o.closeClass).bind("click.simplemodal",function(e){e.preventDefault(),s.close()}),s.o.modal&&s.o.close&&s.o.overlayClose&&s.d.overlay.bind("click.simplemodal",function(e){e.preventDefault(),s.close()}),doc.bind("keydown.simplemodal",function(e){s.o.modal&&e.keyCode===9?s.watchTab(e):s.o.close&&s.o.escClose&&e.keyCode===27&&(e.preventDefault(),s.close())}),wndw.bind("resize.simplemodal orientationchange.simplemodal",function(){s.getDimensions(),s.o.autoResize?s.setContainerDimensions():s.o.autoPosition&&s.setPosition(),ie6||ieQuirks?s.fixIE():s.o.modal&&(s.d.iframe&&s.d.iframe.css({height:w[0],width:w[1]}),s.d.overlay.css({height:d[0],width:d[1]}))})},unbindEvents:function(){$("."+this.o.closeClass).unbind("click.simplemodal"),doc.unbind("keydown.simplemodal"),wndw.unbind(".simplemodal"),this.d.overlay.unbind("click.simplemodal")},fixIE:function(){var s=this,p=s.o.position;$.each([s.d.iframe||null,s.o.modal?s.d.overlay:null,s.d.container.css("position")==="fixed"?s.d.container:null],function(i,el){if(el){var bch="document.body.clientHeight",bcw="document.body.clientWidth",bsh="document.body.scrollHeight",bsl="document.body.scrollLeft",bst="document.body.scrollTop",bsw="document.body.scrollWidth",ch="document.documentElement.clientHeight",cw="document.documentElement.clientWidth",sl="document.documentElement.scrollLeft",st="document.documentElement.scrollTop",s=el[0].style;s.position="absolute";if(i<2)s.removeExpression("height"),s.removeExpression("width"),s.setExpression("height",""+bsh+" > "+bch+" ? "+bsh+" : "+bch+' + "px"'),s.setExpression("width",""+bsw+" > "+bcw+" ? "+bsw+" : "+bcw+' + "px"');else{var te,le;if(p&&p.constructor===Array){var top=p[0]?typeof p[0]=="number"?p[0].toString():p[0].replace(/px/,""):el.css("top").replace(/px/,"");te=top.indexOf("%")===-1?top+" + (t = "+st+" ? "+st+" : "+bst+') + "px"':parseInt(top.replace(/%/,""))+" * (("+ch+" || "+bch+") / 100) + (t = "+st+" ? "+st+" : "+bst+') + "px"';if(p[1]){var left=typeof p[1]=="number"?p[1].toString():p[1].replace(/px/,"");le=left.indexOf("%")===-1?left+" + (t = "+sl+" ? "+sl+" : "+bsl+') + "px"':parseInt(left.replace(/%/,""))+" * (("+cw+" || "+bcw+") / 100) + (t = "+sl+" ? "+sl+" : "+bsl+') + "px"'}}else te="("+ch+" || "+bch+") / 2 - (this.offsetHeight / 2) + (t = "+st+" ? "+st+" : "+bst+') + "px"',le="("+cw+" || "+bcw+") / 2 - (this.offsetWidth / 2) + (t = "+sl+" ? "+sl+" : "+bsl+') + "px"';s.removeExpression("top"),s.removeExpression("left"),s.setExpression("top",te),s.setExpression("left",le)}}})},focus:function(pos){var s=this,p=pos&&$.inArray(pos,["first","last"])!==-1?pos:"first",input=$(":input:enabled:visible:"+p,s.d.wrap);setTimeout(function(){input.length>0?input.focus():s.d.wrap.focus()},10)},getDimensions:function(){var s=this,h=typeof window.innerHeight=="undefined"?wndw.height():window.innerHeight;d=[doc.height(),doc.width()],w=[h,wndw.width()]},getVal:function(v,d){return v?typeof v=="number"?v:v==="auto"?0:v.indexOf("%")>0?parseInt(v.replace(/%/,""))/100*(d==="h"?w[0]:w[1]):parseInt(v.replace(/px/,"")):null},update:function(height,width){var s=this;if(!s.d.data)return!1;s.d.origHeight=s.getVal(height,"h"),s.d.origWidth=s.getVal(width,"w"),s.d.data.hide(),height&&s.d.container.css("height",height),width&&s.d.container.css("width",width),s.setContainerDimensions(),s.d.data.show(),s.o.focus&&s.focus(),s.unbindEvents(),s.bindEvents()},setContainerDimensions:function(){var s=this,badIE=ie6||ie7,ch=s.d.origHeight?s.d.origHeight:$.browser.opera?s.d.container.height():s.getVal(badIE?s.d.container[0].currentStyle.height:s.d.container.css("height"),"h"),cw=s.d.origWidth?s.d.origWidth:$.browser.opera?s.d.container.width():s.getVal(badIE?s.d.container[0].currentStyle.width:s.d.container.css("width"),"w"),dh=s.d.data.outerHeight(!0),dw=s.d.data.outerWidth(!0);s.d.origHeight=s.d.origHeight||ch,s.d.origWidth=s.d.origWidth||cw;var mxoh=s.o.maxHeight?s.getVal(s.o.maxHeight,"h"):null,mxow=s.o.maxWidth?s.getVal(s.o.maxWidth,"w"):null,mh=mxoh&&mxoh<w[0]?mxoh:w[0],mw=mxow&&mxow<w[1]?mxow:w[1],moh=s.o.minHeight?s.getVal(s.o.minHeight,"h"):"auto";ch?ch=s.o.autoResize&&ch>mh?mh:ch<moh?moh:ch:dh?dh>mh?ch=mh:s.o.minHeight&&moh!=="auto"&&dh<moh?ch=moh:ch=dh:ch=moh;var mow=s.o.minWidth?s.getVal(s.o.minWidth,"w"):"auto";cw?cw=s.o.autoResize&&cw>mw?mw:cw<mow?mow:cw:dw?dw>mw?cw=mw:s.o.minWidth&&mow!=="auto"&&dw<mow?cw=mow:cw=dw:cw=mow,s.d.container.css({height:ch,width:cw}),s.d.wrap.css({overflow:dh>ch||dw>cw?"auto":"visible"}),s.o.autoPosition&&s.setPosition()},setPosition:function(){var s=this,top,left,hc=w[0]/2-s.d.container.outerHeight(!0)/2,vc=w[1]/2-s.d.container.outerWidth(!0)/2,st=s.d.container.css("position")!=="fixed"?wndw.scrollTop():0;s.o.position&&Object.prototype.toString.call(s.o.position)==="[object Array]"?(top=st+(s.o.position[0]||hc),left=s.o.position[1]||vc):(top=st+hc,left=vc),s.d.container.css({left:left,top:top})},watchTab:function(e){var s=this;if($(e.target).parents(".simplemodal-container").length>0){s.inputs=$(":input:enabled:visible:first, :input:enabled:visible:last",s.d.data[0]);if(!e.shiftKey&&e.target===s.inputs[s.inputs.length-1]||e.shiftKey&&e.target===s.inputs[0]||s.inputs.length===0){e.preventDefault();var pos=e.shiftKey?"last":"first";s.focus(pos)}}else e.preventDefault(),s.focus()},open:function(){var s=this;s.d.iframe&&s.d.iframe.show(),$.isFunction(s.o.onOpen)?s.o.onOpen.apply(s,[s.d]):(s.d.overlay.show(),s.d.container.show(),s.d.data.show()),s.o.focus&&s.focus(),s.bindEvents()},close:function(){var s=this;if(!s.d.data)return!1;s.unbindEvents();if($.isFunction(s.o.onClose)&&!s.occb)s.occb=!0,s.o.onClose.apply(s,[s.d]);else{if(s.d.placeholder){var ph=$("#simplemodal-placeholder");s.o.persist?ph.replaceWith(s.d.data.removeClass("simplemodal-data").css("display",s.display)):(s.d.data.hide().remove(),ph.replaceWith(s.d.orig))}else s.d.data.hide().remove();s.d.container.hide().remove(),s.d.overlay.hide(),s.d.iframe&&s.d.iframe.hide().remove(),s.d.overlay.remove(),s.d={}}}}}),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};define("models/recipe_ingredient",["backbone"],function(Backbone){var RecipeIngredient;return RecipeIngredient=function(_super){function RecipeIngredient(){return RecipeIngredient.__super__.constructor.apply(this,arguments)}return __extends(RecipeIngredient,_super),RecipeIngredient.prototype.idAttribute="_id",RecipeIngredient.prototype.schema={amount:"Text",unit:"Text",name:"Text"},RecipeIngredient}(Backbone.Model)})}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};define("collections/recipe_ingredients",["backbone","models/recipe_ingredient"],function(Backbone,RecipeIngredient){var RecipeCollection;return RecipeCollection=function(_super){function RecipeCollection(){return RecipeCollection.__super__.constructor.apply(this,arguments)}return __extends(RecipeCollection,_super),RecipeCollection.prototype.model=RecipeIngredient,RecipeCollection}(Backbone.Collection)})}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};define("models/step",["backbone"],function(Backbone){var Step;return Step=function(_super){function Step(){return Step.__super__.constructor.apply(this,arguments)}return __extends(Step,_super),Step.prototype.idAttribute="_id",Step.prototype.schema={description:"Text",start_time:"Text",end_time:"Text"},Step}(Backbone.Model)})}.call(this),function(){define("collections/steps",["lodash","backbone","models/step"],function(_,Backbone,Step){var StepsCollection;return StepsCollection=Backbone.Collection.extend({model:Step})})}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};define("models/recipe",["backbone","models/recipe_ingredient","collections/recipe_ingredients","collections/steps","models/step"],function(Backbone,RecipeIngredient,RecipeIngredients,Steps,Step){var Recipe;return Recipe=function(_super){function Recipe(){return Recipe.__super__.constructor.apply(this,arguments)}return __extends(Recipe,_super),Recipe.prototype.idAttribute="_id",Recipe.prototype.urlRoot="/api/recipes",Recipe.prototype.schema={name:"Text",photo:"Text",description:"Text","Prep time":"Text","Cook time":"Text","Ready In":"Text",serving_size:"Text","Recipe Ingredients":{type:"NestedModel",model:RecipeIngredient},steps:{type:"NestedModel",model:Step}},Recipe.prototype.permalink=function(){return"recipes/"+this.id},Recipe.prototype.initialize=function(){},Recipe.prototype.for_template=function(){var json;return json=this.toJSON(),json.is_authored_by_user?json.url="recipes/edit/"+this.id:json.url="recipes/"+this.id,json},Recipe.prototype.parse=function(response,xhr){var ings;return console.log(response),response.steps=new Steps(response.steps),ings=new RecipeIngredients(response.recipe_ingredients),response.recipe_ingredients=ings,response},Recipe}(Backbone.Model)})}.call(this),define("text",["module"],function(module){var text,fs,progIds=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],xmlRegExp=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,bodyRegExp=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,hasLocation=typeof location!="undefined"&&location.href,defaultProtocol=hasLocation&&location.protocol&&location.protocol.replace(/\:/,""),defaultHostName=hasLocation&&location.hostname,defaultPort=hasLocation&&(location.port||undefined),buildMap=[],masterConfig=module.config&&module.config()||{};text={version:"2.0.3",strip:function(content){if(content){content=content.replace(xmlRegExp,"");var matches=content.match(bodyRegExp);matches&&(content=matches[1])}else content="";return content},jsEscape:function(content){return content.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:masterConfig.createXhr||function(){var xhr,i,progId;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(i=0;i<3;i+=1){progId=progIds[i];try{xhr=new ActiveXObject(progId)}catch(e){}if(xhr){progIds=[progId];break}}return xhr},parseName:function(name){var strip=!1,index=name.indexOf("."),modName=name.substring(0,index),ext=name.substring(index+1,name.length);return index=ext.indexOf("!"),index!==-1&&(strip=ext.substring(index+1,ext.length),strip=strip==="strip",ext=ext.substring(0,index)),{moduleName:modName,ext:ext,strip:strip}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(url,protocol,hostname,port){var uProtocol,uHostName,uPort,match=text.xdRegExp.exec(url);return match?(uProtocol=match[2],uHostName=match[3],uHostName=uHostName.split(":"),uPort=uHostName[1],uHostName=uHostName[0],(!uProtocol||uProtocol===protocol)&&(!uHostName||uHostName.toLowerCase()===hostname.toLowerCase())&&(!uPort&&!uHostName||uPort===port)):!0},finishLoad:function(name,strip,content,onLoad){content=strip?text.strip(content):content,masterConfig.isBuild&&(buildMap[name]=content),onLoad(content)},load:function(name,req,onLoad,config){if(config.isBuild&&!config.inlineText){onLoad();return}masterConfig.isBuild=config.isBuild;var parsed=text.parseName(name),nonStripName=parsed.moduleName+"."+parsed.ext,url=req.toUrl(nonStripName),useXhr=masterConfig.useXhr||text.useXhr;!hasLocation||useXhr(url,defaultProtocol,defaultHostName,defaultPort)?text.get(url,function(content){text.finishLoad(name,parsed.strip,content,onLoad)},function(err){onLoad.error&&onLoad.error(err)}):req([nonStripName],function(content){text.finishLoad(parsed.moduleName+"."+parsed.ext,parsed.strip,content,onLoad)})},write:function(pluginName,moduleName,write,config){if(buildMap.hasOwnProperty(moduleName)){var content=text.jsEscape(buildMap[moduleName]);write.asModule(pluginName+"!"+moduleName,"define(function () { return '"+content+"';});\n")}},writeFile:function(pluginName,moduleName,req,write,config){var parsed=text.parseName(moduleName),nonStripName=parsed.moduleName+"."+parsed.ext,fileName=req.toUrl(parsed.moduleName+"."+parsed.ext)+".js";text.load(nonStripName,req,function(value){var textWrite=function(contents){return write(fileName,contents)};textWrite.asModule=function(moduleName,contents){return write.asModule(moduleName,fileName,contents)},text.write(pluginName,nonStripName,textWrite,config)},config)}};if(masterConfig.env==="node"||!masterConfig.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)fs=require.nodeRequire("fs"),text.get=function(url,callback){var file=fs.readFileSync(url,"utf8");file.indexOf("ï»¿")===0&&(file=file.substring(1)),callback(file)};else if(masterConfig.env==="xhr"||!masterConfig.env&&text.createXhr())text.get=function(url,callback,errback){var xhr=text.createXhr();xhr.open("GET",url,!0),masterConfig.onXhr&&masterConfig.onXhr(xhr,url),xhr.onreadystatechange=function(evt){var status,err;xhr.readyState===4&&(status=xhr.status,status>399&&status<600?(err=new Error(url+" HTTP status: "+status),err.xhr=xhr,errback(err)):callback(xhr.responseText))},xhr.send(null)};else if(masterConfig.env==="rhino"||!masterConfig.env&&typeof Packages!="undefined"&&typeof java!="undefined")text.get=function(url,callback){var stringBuffer,line,encoding="utf-8",file=new java.io.File(url),lineSeparator=java.lang.System.getProperty("line.separator"),input=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(file),encoding)),content="";try{stringBuffer=new java.lang.StringBuffer,line=input.readLine(),line&&line.length()&&line.charAt(0)===65279&&(line=line.substring(1)),stringBuffer.append(line);while((line=input.readLine())!==null)stringBuffer.append(lineSeparator),stringBuffer.append(line);content=String(stringBuffer.toString())}finally{input.close()}callback(content)};return text}),define("text!templates/timeline.html",[],function(){return'<div class="timeline-content">\n    <ul id="time-unit-list">\n    </ul>\n</div>\n'}),define("text!templates/timelineCircle.html",[],function(){return'<li class="time-line circle" id="time-minute-{{index}}">\n    <div class=\'start-circle\' style="border-color: {{color}}">\n        <div class=\'inner-start-circle\' style="background: {{color}}">\n            <div id="start-text">\n                {{ circleText }}\n            </div>\n        </div>\n    </div>\n    <div class="contents-container border-notch">\n        <b class="border-notch notch"></b>\n        <b class="notch"></b>\n        <div class=\'contents\'>\n            {{ text }}\n        </div>\n    </div>\n</li>\n<li class="unit spacer">\n    <div class="line">\n    </div>\n</li>\n'}),define("text!templates/timelineLine.html",[],function(){return'<li class="time-line unit" id="time-minute-{{index}}">\n    <div class="line">\n    </div>\n</li>\n<li class="unit spacer">\n    <div class="line"></div>\n</li>\n'}),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};define("views/recipeTimeline",["backbone","handlebars","models/recipe","text!templates/timeline.html","text!templates/timelineCircle.html","text!templates/timelineLine.html"],function(Backbone,Handlebars,Recipe,timelineTemplate,circleTemplate,lineTemplate){var RecipeTimelineView;return RecipeTimelineView=function(_super){function RecipeTimelineView(){return RecipeTimelineView.__super__.constructor.apply(this,arguments)}return __extends(RecipeTimelineView,_super),RecipeTimelineView.prototype.steps=[],RecipeTimelineView.prototype.num_units=null,RecipeTimelineView.prototype.timeListId="time-unit-list",RecipeTimelineView.prototype.stepListId="step-unit-list",RecipeTimelineView.prototype.start_times=[],RecipeTimelineView.prototype.end_times=[],RecipeTimelineView.prototype.el="#rcontainer",RecipeTimelineView.prototype.scaling=!0,RecipeTimelineView.prototype.initialize=function(steps){return this.timelineTemplate=Handlebars.compile(timelineTemplate),this.lineTemplate=Handlebars.compile(lineTemplate),this.circleTemplate=Handlebars.compile(circleTemplate),this.steps=_.sortBy(steps,function(step){return parseInt(step.start_time)}),this.num_units=parseInt(_.max(this.steps,function(step){return parseInt(step.end_time)}).end_time),this.start_times=_.map(_.pluck(this.steps,"start_time"),function(time){return parseInt(time)}),this.end_times=_.map(_.pluck(this.steps,"end_time"),function(time){return parseInt(time)}),this.render()},RecipeTimelineView.prototype.render=function(){return $(this.el).html(this.timelineTemplate),this.buildTimeline()},RecipeTimelineView.prototype.buildTimeline=function(){var i,steps,time_markers,_i,_ref,_results;_results=[];for(i=_i=0,_ref=this.num_units;0<=_ref?_i<=_ref:_i>=_ref;i=0<=_ref?++_i:--_i)steps=_.filter(this.steps,function(step){return parseInt(step.start_time)===i}),time_markers=_.union(this.start_times,{}),__indexOf.call(time_markers,i)>=0?_results.push($("#"+this.timeListId).append(this.circleTemplate({index:i,circleText:i,color:"#930202",text:_.pluck(steps,"description").join(" ")}))):this.scaling?_results.push($("#"+this.timeListId).append(this.lineTemplate({index:i}))):_results.push(void 0);return _results},RecipeTimelineView}(Backbone.View)})}.call(this),define("text!templates/recipeIngredients.html",[],function(){return'<div id="ingredient-container">\n    <div class="ingredient-contents">\n        <h3>Ingredients:</h3>\n        <ol id="ingredient-list">\n            {{#each ingredients}}\n                <li data-cid={{ this.cid }}>\n                    {{ this.amount }} {{ this.unit }} <b>{{ this.name }}</b>\n                </li>\n            {{/each}}\n        </ol>\n    </div>\n</div>\n'}),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};define("views/recipeIngredients",["backbone","handlebars","models/recipe","collections/recipe_ingredients","text!templates/recipeIngredients.html"],function(Backbone,Handlebars,Recipe,Ingredients,ingredientListTemplate){var RecipeIngredientListView;return RecipeIngredientListView=function(_super){function RecipeIngredientListView(){return RecipeIngredientListView.__super__.constructor.apply(this,arguments)}return __extends(RecipeIngredientListView,_super),RecipeIngredientListView.prototype.el="#icontainer",RecipeIngredientListView.prototype.initialize=function(ingredients){return ingredients.toJSON!=null?this.ingredients=ingredients:this.ingredients=new Ingredients(ingredients),this.template=Handlebars.compile(ingredientListTemplate),this.render()},RecipeIngredientListView.prototype.render=function(){return $("#icontainer").html(this.template({ingredients:this.ingredients.toJSON()}))},RecipeIngredientListView}(Backbone.View)})}.call(this),define("text!templates/recipe.html",[],function(){return'<div class="rheader-background"></div>\n<div class="recipe">\n    <div class="haha">\n        <div class="rheader">\n            <div class="one-col">\n                <div class="img-circle"></div>\n            </div>\n            <div class="two-col">\n                <h1 class="title">{{name}}</h1>\n                <h2 class="description">{{description}}</h2>\n                <table>\n                    <tr>\n                        <td class="label">Prep Time</td>\n                        <td class="prep-time">{{prep_time}}</td>\n                    </tr>\n                    <tr>\n                        <td class="label">Cook Time</td>\n                        <td class="cook-time">{{cook_time}}</td>\n                    </tr>\n                    <tr>\n                        <td class="label">Ready In</td>\n                        <td class="ready-in">{{ready_in}}</td>\n                    </tr>\n                </table>\n                <br />\n                <table>\n                    <tr>\n                        <td class="label">Serves</td>\n                        <td class="serving">{{ serving_size }}</td>\n                    </tr>\n                </table>\n                <div id="recipe-actions">\n                    {{#if is_favorited_by_user}}\n                    <a href="#" id="unfavorite-recipe-button">Unfavorite</a>\n                    {{else}}\n                    <a href="#" id="favorite-recipe-button">Favorite</a>\n                    {{/if}}\n                </div>\n            </div>\n        </div>\n    </div>\n    <div id="rcontainer">\n    </div>\n    <div id="icontainer">\n    </div>\n</div>\n'}),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};define("views/recipe",["backbone","handlebars","models/recipe","views/recipeTimeline","views/recipeIngredients","text!templates/recipe.html"],function(Backbone,Handlebars,Recipe,Timeline,IngredientList,recipeTemplateHtml){var RecipeView;return RecipeView=function(_super){function RecipeView(){return RecipeView.__super__.constructor.apply(this,arguments)}return __extends(RecipeView,_super),RecipeView.prototype.steps=[],RecipeView.prototype.timelineEl="#rcontainer",RecipeView.prototype.events={"click a#favorite-recipe-button":"favorite","click a#unfavorite-recipe-button":"unfavorite"},RecipeView.prototype.initialize=function(params){var _this=this;return this.template=Handlebars.compile(recipeTemplateHtml),this.model=new Recipe({_id:params.id}),this.model.fetch({success:function(){return _this.steps=[],_.each(_this.model.get("steps").toJSON(),function(step){return _this.steps.push(step)}),_this.render(),_this.renderTimeline(),_this.renderIngredients()}})},RecipeView.prototype.render=function(){return this.$el.html(this.template(this.model.for_template())),$(".img-circle").first().css("background","url('"+this.model.attributes.photo+"')")},RecipeView.prototype.renderTimeline=function(){var timeLine;return timeLine=new Timeline(this.steps)},RecipeView.prototype.renderIngredients=function(){var ingredientsList;return ingredientsList=new IngredientList(this.model.get("recipe_ingredients"))},RecipeView.prototype.favorite=function(e){var _this=this;return e.preventDefault(),$.ajax({type:"POST",url:"/api/recipes/favorite/"+this.model.get("_id"),dataType:"json",data:{authenticity_token:$("meta[name='csrf-token']").attr("content")},success:function(){return $("#favorite-recipe-button").text("Unfavorite").attr("id","unfavorite-recipe-button"),_this.model.set("is_favorited_by_user?",!0)},error:function(){return alert("Error!")}}),!1},RecipeView.prototype.unfavorite=function(e){var _this=this;return e.preventDefault(),$.ajax({type:"POST",url:"/api/recipes/unfavorite/"+this.model.get("_id"),dataType:"json",data:{authenticity_token:$("meta[name='csrf-token']").attr("content")},success:function(){return $("#unfavorite-recipe-button").text("Favorite").attr("id","favorite-recipe-button"),_this.model.set("is_favorited_by_user?",!1)},error:function(){return alert("Error!")}}),!1},RecipeView}(Backbone.View)})}.call(this),function(){define("collections/recipes",["lodash","backbone","models/recipe"],function(_,Backbone,Recipe){var RecipesCollection;return RecipesCollection=Backbone.Collection.extend({url:"/api/recipes#index",model:Recipe,initialize:function(params){if(params)return this.url=params.url},for_template:function(){return _.map(this.models,function(recipe){return recipe.for_template()})}})})}.call(this),define("text!templates/recipeList.html",[],function(){return'<ul class="recipe-list" id={{ listId }}>\n    {{#each recipes}}\n        <li>\n            <a href="{{this.url}}">\n                <img src="{{this.photo}}"/>\n            </a>\n            <div class="name-background">\n                <span class="name-text">\n                    {{this.name}}\n                </span>\n            </div>\n        </li>\n    {{else}}\n        <i>Nothing here</i>\n    {{/each}}\n</ul>\n'}),function(){define("views/recipeList",["jquery","lodash","backbone","handlebars","collections/recipes","text!templates/recipeList.html"],function($,_,Backbone,Handlebars,RecipesCollection,recipeListTemplate){var RecipeListView;return RecipeListView=Backbone.View.extend({initialize:function(){var recipeList,_this=this;return this.collection=new RecipesCollection,this.template=Handlebars.compile(recipeListTemplate),recipeList=this.collection.fetch({success:function(){return _this.render()}})},render:function(){return this.$el.html(this.template({recipes:this.collection.for_template()}))}})})}.call(this),define("text!templates/dashboard.html",[],function(){return'<div class="rlist-background">\n</div>\n<div class="recipe-list-container">\n    <h1>My Favorite Grubs</h1>\n    <div id="favorites-container">\n    </div>\n    <h1>My Published Grubs</h1>\n    <div id="published-container">\n    </div>\n    <h1>My Unpublished Grubs</h1>\n    <div id="unpublished-container">\n    </div>\n    <!--h1>All Public Grubs</h1>\n    <div id="all-container">\n    </div-->\n</div>\n'}),function(){define("views/dashboard",["jquery","lodash","backbone","handlebars","collections/recipes","views/recipeList","text!templates/recipeList.html","text!templates/dashboard.html"],function($,_,Backbone,Handlebars,RecipesCollection,RecipeListView,recipeListTemplate,dashboardTemplate){var Dashboard;return Dashboard=Backbone.View.extend({initialize:function(){var favorites,published,unpublished,_this=this;return this.favorites=new RecipesCollection({url:"/api/recipes/favorites.json"}),this.published=new RecipesCollection({url:"/api/recipes/published.json"}),this.unpublished=new RecipesCollection({url:"/api/recipes/unpublished.json"}),this.dashHtml=Handlebars.compile(dashboardTemplate),this.recipeListHtml=Handlebars.compile(recipeListTemplate),this.render(),favorites=this.favorites.fetch({success:function(){return _this.renderFavorites()}}),published=this.published.fetch({success:function(){return _this.renderPublished()}}),unpublished=this.unpublished.fetch({success:function(){return _this.renderUnpublished()}})},render:function(){return this.$el.html(this.dashHtml)},renderFavorites:function(){return $("#favorites-container").html(this.recipeListHtml({recipes:this.favorites.for_template(),listId:"favorited-recipe"}))},renderPublished:function(){return $("#published-container").html(this.recipeListHtml({recipes:this.published.for_template(),listId:"published-recipe"}))},renderUnpublished:function(){return $("#unpublished-container").html(this.recipeListHtml({recipes:this.unpublished.for_template(),listId:"unpublished-recipe"}))}})})}.call(this),define("text!templates/search.html",[],function(){return'<div class="search-background">\n</div>\n<div id="wrap-push">\n    <div id="search-box-container">\n        <h1>Start a new recipe search: </h1>\n        <form id="search-form" method="GET" action="/api/search">\n            <input type="text" id="search-input" name="q" placeholder="eg. Spaghetti, Soup" value=\'{{query}}\'>\n            <input type="submit" value="Search">\n        </form>\n    </div>\n</div>\n'}),define("text!templates/search_result_container.html",[],function(){return'<div id="results-container" style="overflow: hidden">\n    <h3 style="line-height: 1.0em"><i>Results for <span id="q-ind">query</span></i>: </h3>\n    <ul id="results-list">\n    </ul>\n</div>\n'}),define("text!templates/search_result.html",[],function(){return'<a href="/recipes/{{_id}}" style="color:white">\n<li class="result" style="margin-bottom:20px; overflow: hidden">\n    <div id="result-img-container" style="float: left">\n        <img src="{{ photo }}" width=120px height=120px style="border: 5px solid white; box-shadow: 0 0 4px #000" />\n    </div>\n    <div id="text-content" style="float: left; margin-left: 20px; width: 400px;padding: 15px">\n        <h3 style="margin: 0">{{ name }}</h3>\n        <p>{{ description }}</p>\n    </div>\n</li>\n</a>\n'}),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};define("views/search",["backbone","handlebars","text!templates/search.html","text!templates/search_result_container.html","text!templates/search_result.html"],function(Backbone,Handlebars,indexTemplateHtml,searchResultContainerHtml,searchResultHtml){var IndexView;return IndexView=function(_super){function IndexView(){return IndexView.__super__.constructor.apply(this,arguments)}return __extends(IndexView,_super),IndexView.prototype.query="",IndexView.prototype.events={"submit #search-form":"doSearch"},IndexView.prototype.initialize=function(q){return this.template=Handlebars.compile(indexTemplateHtml),this.resContainerTemplate=Handlebars.compile(searchResultContainerHtml),this.searchResultHtml=Handlebars.compile(searchResultHtml),this.query=q,this.render(),!1},IndexView.prototype.render=function(){return this.$el.html(this.template({query:this.query})),this.doSearch()},IndexView.prototype.renderResults=function(data){var _this=this;return _.isEmpty($("#results-container"))&&$("#wrap-push").append(this.resContainerTemplate),$("#results-list").html(""),_.each(data,function(recipe){return recipe.description=recipe.description.substring(0,150)+"...",$("#results-list").append(_this.searchResultHtml(recipe))})},IndexView.prototype.doSearch=function(e){var baseUrl,url,_this=this;e!=null&&(e.preventDefault(),this.query=$("input[name=q]").val(),window.router.navigate("recipes/search/"+this.query));if(!_.isEmpty(this.query))return baseUrl="/api/recipes/search.json",url=""+baseUrl+"?q="+this.query,$.getJSON(url,function(data){return _this.renderResults(data),_this.updateQueryIndicator(_this.query)}),!1},IndexView.prototype.updateQueryIndicator=function(queryString){return $("span#q-ind").text(queryString)},IndexView}(Backbone.View)})}.call(this),define("text!templates/createRecipe.html",[],function(){return'<div class="rheader-background"></div>\n<div class="recipe">\n    <div class="haha">\n        <div class="rheader">\n            <div class="one-col">\n                <div class="img-circle editable" id="recipe-photo" data-edit="text" data-field="photo"></div>\n            </div>\n            <div class="two-col">\n                <h1 class="title editable" id="recipe-name" data-edit="text" data-field="name">{{name}}</h1>\n                <h2 class="description editable" id="recipe-description" data-edit="textarea" data-field="description">{{description}}</h2>\n                <table>\n                    <tr id="recipe-preptime">\n                        <td class="label">Prep Time</td>\n                        <td class="prep-time editable" data-edit="text" data-field="prep_time">{{prep_time}}</td>\n                    </tr>\n                    <tr id="recipe-cooktime">\n                        <td class="label">Cook Time</td>\n                        <td class="cook-time editable" data-edit="text" data-field="cook_time">{{cook_time}}</td>\n                    </tr>\n                    <tr id="recipe-readyin">\n                        <td class="label">Ready In</td>\n                        <td class="ready-in editable" data-edit="text" data-field="ready_in">{{ready_in}}</td>\n                    </tr>\n                </table>\n                <br />\n                <table>\n                    <tr id="recipe-servingsize">\n                        <td class="label">Serves</td>\n                        <td class="serving editable" data-edit="text" data-field="serving_size">{{ serving_size }}</td>\n                    </tr>\n                </table>\n                <div id="recipe-actions">\n                    {{#if is_favorited_by_user}}\n                    <a href="#" id="unfavorite-recipe-button">Unfavorite</a>\n                    {{else}}\n                    <a href="#" id="favorite-recipe-button">Favorite</a>\n                    {{/if}}\n                    <a href="#" id="submit-create-recipe">Save</a>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div id="rcontainer">\n    </div>\n    <div id="icontainer">\n    </div>\n</div>\n'}),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};define("views/createRecipe",["backbone","handlebars","lodash","jquery","jquery.simplemodal","models/recipe","models/recipe_ingredient","models/step","collections/steps","collections/recipe_ingredients","views/recipeTimeline","views/recipeIngredients","text!templates/createRecipe.html"],function(Backbone,Handlebars,_,$,simplemodal,Recipe,RecipeIngredient,Step,StepList,RecipeIngredients,Timeline,IngredientList,createRecipeTemplate){var CreateRecipeView;return CreateRecipeView=function(_super){function CreateRecipeView(){return CreateRecipeView.__super__.constructor.apply(this,arguments)}return __extends(CreateRecipeView,_super),CreateRecipeView.prototype.events={"mouseover .editable":"highlight","mouseout .editable":"unhighlight","mouseover li.ingredient-editable":"highlight","mouseout li.ingredient-editable":"unhighlight","click #new-ingredient":"createIngredient","dblclick #ingredient-list li.ingredient-editable":"editIngredient","dblclick .editable":"edit","mouseover .contents-container .contents":"highlight","mouseout .contents-container .contents":"unhighlight","dblclick .contents-container .contents":"editStep","click .unit":"addStep","click a#favorite-recipe-button":"favorite","click a#unfavorite-recipe-button":"unfavorite"},CreateRecipeView.prototype.initialize=function(params){var _this=this;return this.template=Handlebars.compile(createRecipeTemplate),params!=null&&params.id!=null?(this.model=new Recipe({_id:params.id}),this.model.fetch({success:function(){return _this.render()}})):this.model=new Recipe({name:"Double click here to edit the recipe name.",photo:"http://freecoloringpagesite.com/coloring-pics/blue-coloring-2.png",description:"Double click here to edit the recipe description. Additionally, you can double click any thing on this recipe to edit it.",prep_time:"0",cook_time:"0",ready_in:"0",serving_size:"0",recipe_ingredients:new RecipeIngredients,steps:new StepList([new Step({description:"Click here to edit this step.",start_time:0,end_time:30})])})},CreateRecipeView.prototype.render=function(){var _this=this;return this.$el.html(this.template(this.model.for_template())),$(".recipe").ready(function(){return $(".img-circle").first().css("background","url('"+_this.model.attributes.photo+"')"),_this.renderIngredients(),_this.renderTimeline(),_this.renderFormActions()})},CreateRecipeView.prototype.renderFormActions=function(){var _this=this;return $("#submit-create-recipe").on("click",function(e){return e.preventDefault(),_this.saveRecipe(),!1})},CreateRecipeView.prototype.renderIngredients=function(){var ingredients,_this=this;return console.log("Rendered Ingredients"),ingredients=this.model.get("recipe_ingredients"),_.each(ingredients.models,function(ing){return ing.set("cid",ing.cid)}),this.ingredientsList=new IngredientList(ingredients),$(".ingredient-contents").ready(function(){return $("#ingredient-list li").addClass("ingredient-editable"),$("#ingredient-list").append("<li style='list-style-type: none;'>                                      <a href='#' id='new-ingredient'>                                      + Add Ingredient</a></li>")})},CreateRecipeView.prototype.renderTimeline=function(){var steps;return steps=this.model.get("steps"),steps.toJSON!=null?this.timeline=new Timeline(steps.toJSON()):this.timeline=new Timeline(steps)},CreateRecipeView.prototype.highlight=function(e){return $(e.target).hasClass("img-circle")?$(e.target).css("border-color","#ffff99"):$(e.target).css("background","#ffff99"),$(e.target).css("color","#478dff")},CreateRecipeView.prototype.unhighlight=function(e){return $(e.target).hasClass("img-circle")?$(e.target).css("border-color","#fff"):$(e.target).css("background","none"),$(e.target).css("color","black")},CreateRecipeView.prototype.edit=function(e){var field,html,text,type,_this=this;return e.preventDefault(),type=$(e.target).attr("data-edit"),field=$(e.target).attr("data-field"),html="<form id='edit-recipe-field-form'>",text=this.model.get(field),type==="textarea"?html+="<textarea name='edit' rows=6 cols=60>"+text+"</textarea>                  <br /><br/><input type='submit' class='submit-button'>":html+="<input type='text' name='edit' value='"+text+"' size=60/>                  <br /><br /><input type='submit' class='submit-button'>",html+="</form>",$.modal(html,{onShow:function(dialog){return $("#edit-recipe-field-form").on("submit",function(e){return e.preventDefault(),_this.model.set(field,$("input[name=edit], textarea[name=edit]").val()),$.modal.close(),_this.render(),!1})}})},CreateRecipeView.prototype.editIngredient=function(e){var html,_this=this;return e.preventDefault(),html="<form id='edit-ingredient-form'>                  <p><input type='text' name='amount' placeholder='Amount'/></p>                  <p><input type='text' name='unit' placeholder='Unit'/></p>                  <p><input type='text' name='name' placeholder='Name'/></p>                  <input type='submit'>                </form>",$.modal(html,{onShow:function(dialog){var ingredient,recipe_ingredients;return recipe_ingredients=_this.model.get("recipe_ingredients"),console.log(recipe_ingredients),ingredient=recipe_ingredients.getByCid($(e.target).closest(".ingredient-editable").attr("data-cid")),$("input[name=amount]").val(ingredient.get("amount")),$("input[name=unit]").val(ingredient.get("unit")),$("input[name=name]").val(ingredient.get("name")),$("#edit-ingredient-form").on("submit",function(e){return e.preventDefault(),ingredient.set("amount",$("input[name=amount]").val()),ingredient.set("unit",$("input[name=unit]").val()),ingredient.set("name",$("input[name=name]").val()),$.modal.close(),_this.renderIngredients(),!1})}})},CreateRecipeView.prototype.createIngredient=function(e){var html,_this=this;return e.preventDefault(),html="<form id='create-ingredient-form'>                  <p><input type='text' name='amount' placeholder='Amount'/></p>                  <p><input type='text' name='unit' placeholder='Unit'/></p>                  <p><input type='text' name='name' placeholder='Name'/></p>                  <input type='submit'>                </form>",$.modal(html,{onShow:function(dialog){return $("#create-ingredient-form").on("submit",function(e){var amount,ings,name,rIng,unit;return e.preventDefault(),ings=_this.model.get("recipe_ingredients"),amount=$("input[name=amount]").val(),unit=$("input[name=unit]").val(),name=$("input[name=name]").val(),rIng=new RecipeIngredient({amount:amount,unit:unit,name:name}),rIng.set("cid",rIng.cid),ings.push(rIng),_this.model.set("recipe_ingredients",ings),$.modal.close(),_this.renderIngredients(),!1})}}),!1},CreateRecipeView.prototype.editStep=function(e){var html,text,_this=this;return e.preventDefault(),text=$(e.target).text().trim(),html="<form id='edit-step-form'>                  <textarea name='step' rows=5 cols=40>"+text+"</textarea>                  <br />                  <br />                  <input type='submit'>                </form>",$.modal(html,{onShow:function(dialog){return $("#edit-step-form").on("submit",function(e){var new_text,step,steps;return e.preventDefault(),steps=_this.model.get("steps"),step=steps.where({description:text})[0],new_text=$("textarea[name='step']").val(),step.set("description",new_text),$.modal.close(),_this.renderTimeline()})}})},CreateRecipeView.prototype.addStep=function(e){var html,_this=this;return e.preventDefault(),html="<form id='add-step-form'>                  <textarea name='description' rows=5 cols=40></textarea>                  <br />                  <p>                  <input type='text' name='start_time' placeholder='Start time'/><br />                  <input type='text' name='end_time' placeholder='End time'/><br />                  </p>                  <br />                  <input type='submit'>                </form>",$.modal(html,{onShow:function(dialog){return $("#add-step-form").on("submit",function(e){var description,end_time,start_time,steps;return e.preventDefault(),description=$("textarea[name=description]").val(),start_time=$("input[name=start_time]").val(),end_time=$("input[name=end_time]").val(),steps=_this.model.get("steps"),steps.push(new Step({description:description,start_time:start_time,end_time:end_time})),_this.model.set("steps",steps),$.modal.close(),_this.renderTimeline()})}})},CreateRecipeView.prototype.saveRecipe=function(){var recipe_collection,steps,_this=this;return recipe_collection=this.model.get("recipe_collection"),steps=this.model.get("steps"),this.model.save(null,{success:function(){return console.log("Saved"),_this.renderIngredients()},error:function(){return console.log("Error")}})},CreateRecipeView.prototype.favorite=function(e){var _this=this;return e.preventDefault(),$.ajax({type:"POST",url:"/api/recipes/favorite/"+this.model.get("_id"),dataType:"json",data:{authenticity_token:$("meta[name='csrf-token']").attr("content")},success:function(){return $("#favorite-recipe-button").text("Unfavorite").attr("id","unfavorite-recipe-button"),_this.model.set("is_favorited_by_user?",!0)},error:function(){return alert("Error!")}}),!1},CreateRecipeView.prototype.unfavorite=function(e){var _this=this;return e.preventDefault(),$.ajax({type:"POST",url:"/api/recipes/unfavorite/"+this.model.get("_id"),dataType:"json",data:{authenticity_token:$("meta[name='csrf-token']").attr("content")},success:function(){return $("#unfavorite-recipe-button").text("Favorite").attr("id","favorite-recipe-button"),_this.model.set("is_favorited_by_user?",!1)},error:function(){return alert("Error!")}}),!1},CreateRecipeView}(Backbone.View)})}.call(this),function(){define("router",["backbone","views/recipe","views/dashboard","views/search","views/createRecipe"],function(Backbone,RecipeView,DashboardView,IndexView,CreateRecipeView){var Router,initialize;return Router=Backbone.Router.extend({routes:{"":"index","recipes/search/:q":"index",recipes:"showDashboard","recipes/create":"createRecipe","recipes/edit/:id":"editRecipe","recipes/:id":"showRecipe"},start:function(){return Backbone.history.start({pushState:!0})},index:function(q){var indexView;return q!=null?indexView=new IndexView(q):indexView=new IndexView,$("section.container").html(indexView.el)},showRecipe:function(id){var recipeView;return recipeView=new RecipeView({id:id}),$("section.container").html(recipeView.el)},showDashboard:function(){var dashboardView;return dashboardView=new DashboardView,$("section.container").html(dashboardView.el)},createRecipe:function(){var createRecipeView;return createRecipeView=new CreateRecipeView,$("section.container").html(createRecipeView.el),createRecipeView.render()},editRecipe:function(id){var editRecipeView;return editRecipeView=new CreateRecipeView({id:id}),$("section.container").html(editRecipeView.el)}}),initialize=function(){return window.router=new Router,window.router.start()},{initialize:initialize}})}.call(this),function(){define("application",["jquery","jquery.simplemodal","lodash","backbone","handlebars","router"],function($,simplemodal,_,Backbone,Handlebars,Router){var initialize,setModalDefaults;return initialize=function(){return setModalDefaults(),Backbone.emulateHTTP=!0,Router.initialize()},setModalDefaults=function(){return $.modal.defaults.closeClass="modalClose",$.modal.defaults.overlayClose=!0},{initialize:initialize,root:"/"}})}.call(this),function(){require(["application","backbone"],function(App){return App.initialize(),$(document).on("click","a:not([data-bypass])",function(e){var href,root;href={prop:$(this).prop("href"),attr:$(this).attr("href")},root=""+location.protocol+"//"+location.host+App.root;if(href.prop&&href.prop.slice(0,root.length)===root)return e.preventDefault(),Backbone.history.navigate(href.attr,!0)})})}.call(this),define("main",function(){})