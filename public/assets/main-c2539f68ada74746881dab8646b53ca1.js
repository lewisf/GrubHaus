/*
 * SimpleModal @VERSION - jQuery Plugin
 * http://simplemodal.com/
 * Copyright (c) 2012 Eric Martin
 * Licensed under MIT and GPL
 * Date:
 */

/**
 * @license RequireJS text 2.0.3 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

(function(e){typeof define=="function"&&define.amd?define("jquery.simplemodal",["jquery"],e):e(jQuery)})(function(e){var t=[],n=e(document),r=e.browser.msie&&parseInt(e.browser.version)===6&&typeof window.XMLHttpRequest!="object",i=e.browser.msie&&parseInt(e.browser.version)===7,s=null,o=e(window),u=[];e.modal=function(t,n){return e.modal.impl.init(t,n)},e.modal.close=function(){e.modal.impl.close()},e.modal.focus=function(t){e.modal.impl.focus(t)},e.modal.setContainerDimensions=function(){e.modal.impl.setContainerDimensions()},e.modal.setPosition=function(){e.modal.impl.setPosition()},e.modal.update=function(t,n){e.modal.impl.update(t,n)},e.fn.modal=function(t){return e.modal.impl.init(this,t)},e.modal.defaults={appendTo:"body",focus:!0,opacity:50,overlayId:"simplemodal-overlay",overlayCss:{},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!1,autoPosition:!0,zIndex:1e3,close:!0,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"simplemodal-close",escClose:!0,overlayClose:!1,fixed:!0,position:null,persist:!1,modal:!0,onOpen:null,onShow:null,onClose:null},e.modal.impl={d:{},init:function(t,n){var r=this;if(r.d.data)return!1;s=e.browser.msie&&!e.support.boxModel,r.o=e.extend({},e.modal.defaults,n),r.zIndex=r.o.zIndex,r.occb=!1;if(typeof t=="object")t=t instanceof e?t:e(t),r.d.placeholder=!1,t.parent().parent().size()>0&&(t.before(e("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"})),r.d.placeholder=!0,r.display=t.css("display"),r.o.persist||(r.d.orig=t.clone(!0)));else{if(typeof t!="string"&&typeof t!="number")return alert("SimpleModal Error: Unsupported data type: "+typeof t),r;t=e("<div></div>").html(t)}return r.create(t),t=null,r.open(),e.isFunction(r.o.onShow)&&r.o.onShow.apply(r,[r.d]),r},create:function(n){var i=this;i.getDimensions(),i.o.modal&&r&&(i.d.iframe=e('<iframe src="javascript:false;"></iframe>').css(e.extend(i.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:u[0],width:u[1],zIndex:i.o.zIndex,top:0,left:0})).appendTo(i.o.appendTo)),i.d.overlay=e("<div></div>").attr("id",i.o.overlayId).addClass("simplemodal-overlay").css(e.extend(i.o.overlayCss,{display:"none",opacity:i.o.opacity/100,height:i.o.modal?t[0]:0,width:i.o.modal?t[1]:0,position:"fixed",left:0,top:0,zIndex:i.o.zIndex+1})).appendTo(i.o.appendTo),i.d.container=e("<div></div>").attr("id",i.o.containerId).addClass("simplemodal-container").css(e.extend({position:i.o.fixed?"fixed":"absolute"},i.o.containerCss,{display:"none",zIndex:i.o.zIndex+2})).append(i.o.close&&i.o.closeHTML?e(i.o.closeHTML).addClass(i.o.closeClass):"").appendTo(i.o.appendTo),i.d.wrap=e("<div></div>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(i.d.container),i.d.data=n.attr("id",n.attr("id")||i.o.dataId).addClass("simplemodal-data").css(e.extend(i.o.dataCss,{display:"none"})).appendTo("body"),n=null,i.setContainerDimensions(),i.d.data.appendTo(i.d.wrap),(r||s)&&i.fixIE()},bindEvents:function(){var i=this;e("."+i.o.closeClass).bind("click.simplemodal",function(e){e.preventDefault(),i.close()}),i.o.modal&&i.o.close&&i.o.overlayClose&&i.d.overlay.bind("click.simplemodal",function(e){e.preventDefault(),i.close()}),n.bind("keydown.simplemodal",function(e){i.o.modal&&e.keyCode===9?i.watchTab(e):i.o.close&&i.o.escClose&&e.keyCode===27&&(e.preventDefault(),i.close())}),o.bind("resize.simplemodal orientationchange.simplemodal",function(){i.getDimensions(),i.o.autoResize?i.setContainerDimensions():i.o.autoPosition&&i.setPosition(),r||s?i.fixIE():i.o.modal&&(i.d.iframe&&i.d.iframe.css({height:u[0],width:u[1]}),i.d.overlay.css({height:t[0],width:t[1]}))})},unbindEvents:function(){e("."+this.o.closeClass).unbind("click.simplemodal"),n.unbind("keydown.simplemodal"),o.unbind(".simplemodal"),this.d.overlay.unbind("click.simplemodal")},fixIE:function(){var t=this,n=t.o.position;e.each([t.d.iframe||null,t.o.modal?t.d.overlay:null,t.d.container.css("position")==="fixed"?t.d.container:null],function(e,t){if(t){var r="document.body.clientHeight",i="document.body.clientWidth",s="document.body.scrollHeight",o="document.body.scrollLeft",u="document.body.scrollTop",a="document.body.scrollWidth",f="document.documentElement.clientHeight",l="document.documentElement.clientWidth",c="document.documentElement.scrollLeft",h="document.documentElement.scrollTop",d=t[0].style;d.position="absolute";if(e<2)d.removeExpression("height"),d.removeExpression("width"),d.setExpression("height",""+s+" > "+r+" ? "+s+" : "+r+' + "px"'),d.setExpression("width",""+a+" > "+i+" ? "+a+" : "+i+' + "px"');else{var v,m;if(n&&n.constructor===Array){var g=n[0]?typeof n[0]=="number"?n[0].toString():n[0].replace(/px/,""):t.css("top").replace(/px/,"");v=g.indexOf("%")===-1?g+" + (t = "+h+" ? "+h+" : "+u+') + "px"':parseInt(g.replace(/%/,""))+" * (("+f+" || "+r+") / 100) + (t = "+h+" ? "+h+" : "+u+') + "px"';if(n[1]){var y=typeof n[1]=="number"?n[1].toString():n[1].replace(/px/,"");m=y.indexOf("%")===-1?y+" + (t = "+c+" ? "+c+" : "+o+') + "px"':parseInt(y.replace(/%/,""))+" * (("+l+" || "+i+") / 100) + (t = "+c+" ? "+c+" : "+o+') + "px"'}}else v="("+f+" || "+r+") / 2 - (this.offsetHeight / 2) + (t = "+h+" ? "+h+" : "+u+') + "px"',m="("+l+" || "+i+") / 2 - (this.offsetWidth / 2) + (t = "+c+" ? "+c+" : "+o+') + "px"';d.removeExpression("top"),d.removeExpression("left"),d.setExpression("top",v),d.setExpression("left",m)}}})},focus:function(t){var n=this,r=t&&e.inArray(t,["first","last"])!==-1?t:"first",i=e(":input:enabled:visible:"+r,n.d.wrap);setTimeout(function(){i.length>0?i.focus():n.d.wrap.focus()},10)},getDimensions:function(){var e=this,r=typeof window.innerHeight=="undefined"?o.height():window.innerHeight;t=[n.height(),n.width()],u=[r,o.width()]},getVal:function(e,t){return e?typeof e=="number"?e:e==="auto"?0:e.indexOf("%")>0?parseInt(e.replace(/%/,""))/100*(t==="h"?u[0]:u[1]):parseInt(e.replace(/px/,"")):null},update:function(e,t){var n=this;if(!n.d.data)return!1;n.d.origHeight=n.getVal(e,"h"),n.d.origWidth=n.getVal(t,"w"),n.d.data.hide(),e&&n.d.container.css("height",e),t&&n.d.container.css("width",t),n.setContainerDimensions(),n.d.data.show(),n.o.focus&&n.focus(),n.unbindEvents(),n.bindEvents()},setContainerDimensions:function(){var t=this,n=r||i,s=t.d.origHeight?t.d.origHeight:e.browser.opera?t.d.container.height():t.getVal(n?t.d.container[0].currentStyle.height:t.d.container.css("height"),"h"),o=t.d.origWidth?t.d.origWidth:e.browser.opera?t.d.container.width():t.getVal(n?t.d.container[0].currentStyle.width:t.d.container.css("width"),"w"),a=t.d.data.outerHeight(!0),f=t.d.data.outerWidth(!0);t.d.origHeight=t.d.origHeight||s,t.d.origWidth=t.d.origWidth||o;var l=t.o.maxHeight?t.getVal(t.o.maxHeight,"h"):null,c=t.o.maxWidth?t.getVal(t.o.maxWidth,"w"):null,h=l&&l<u[0]?l:u[0],p=c&&c<u[1]?c:u[1],d=t.o.minHeight?t.getVal(t.o.minHeight,"h"):"auto";s?s=t.o.autoResize&&s>h?h:s<d?d:s:a?a>h?s=h:t.o.minHeight&&d!=="auto"&&a<d?s=d:s=a:s=d;var v=t.o.minWidth?t.getVal(t.o.minWidth,"w"):"auto";o?o=t.o.autoResize&&o>p?p:o<v?v:o:f?f>p?o=p:t.o.minWidth&&v!=="auto"&&f<v?o=v:o=f:o=v,t.d.container.css({height:s,width:o}),t.d.wrap.css({overflow:a>s||f>o?"auto":"visible"}),t.o.autoPosition&&t.setPosition()},setPosition:function(){var e=this,t,n,r=u[0]/2-e.d.container.outerHeight(!0)/2,i=u[1]/2-e.d.container.outerWidth(!0)/2,s=e.d.container.css("position")!=="fixed"?o.scrollTop():0;e.o.position&&Object.prototype.toString.call(e.o.position)==="[object Array]"?(t=s+(e.o.position[0]||r),n=e.o.position[1]||i):(t=s+r,n=i),e.d.container.css({left:n,top:t})},watchTab:function(t){var n=this;if(e(t.target).parents(".simplemodal-container").length>0){n.inputs=e(":input:enabled:visible:first, :input:enabled:visible:last",n.d.data[0]);if(!t.shiftKey&&t.target===n.inputs[n.inputs.length-1]||t.shiftKey&&t.target===n.inputs[0]||n.inputs.length===0){t.preventDefault();var r=t.shiftKey?"last":"first";n.focus(r)}}else t.preventDefault(),n.focus()},open:function(){var t=this;t.d.iframe&&t.d.iframe.show(),e.isFunction(t.o.onOpen)?t.o.onOpen.apply(t,[t.d]):(t.d.overlay.show(),t.d.container.show(),t.d.data.show()),t.o.focus&&t.focus(),t.bindEvents()},close:function(){var t=this;if(!t.d.data)return!1;t.unbindEvents();if(e.isFunction(t.o.onClose)&&!t.occb)t.occb=!0,t.o.onClose.apply(t,[t.d]);else{if(t.d.placeholder){var n=e("#simplemodal-placeholder");t.o.persist?n.replaceWith(t.d.data.removeClass("simplemodal-data").css("display",t.display)):(t.d.data.hide().remove(),n.replaceWith(t.d.orig))}else t.d.data.hide().remove();t.d.container.hide().remove(),t.d.overlay.hide(),t.d.iframe&&t.d.iframe.hide().remove(),t.d.overlay.remove(),t.d={}}}}}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("models/recipe_ingredient",["backbone"],function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.idAttribute="_id",n.prototype.schema={amount:"Text",unit:"Text",name:"Text"},n}(e.Model)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("models/step",["backbone"],function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.idAttribute="_id",n.prototype.schema={description:"Text",start_time:"Text",end_time:"Text"},n}(e.Model)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("models/recipe",["backbone","models/recipe_ingredient","models/step"],function(e,n,r){var i;return i=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.idAttribute="_id",i.prototype.urlRoot="/api/recipes",i.prototype.schema={name:"Text",photo:"Text",description:"Text","Prep time":"Text","Cook time":"Text","Ready In":"Text",serving_size:"Text","Recipe Ingredients":{type:"NestedModel",model:n},steps:{type:"NestedModel",model:r}},i.prototype.permalink=function(){return"recipes/"+this.id},i.prototype.initialize=function(){},i.prototype.for_template=function(){var e;return e=this.toJSON(),e.url=this.permalink(),e},i}(e.Model)})}.call(this),define("text",["module"],function(e){var t,n,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,o=typeof location!="undefined"&&location.href,u=o&&location.protocol&&location.protocol.replace(/\:/,""),a=o&&location.hostname,f=o&&(location.port||undefined),l=[],c=e.config&&e.config()||{};t={version:"2.0.3",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:c.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),i=e.substring(n+1,e.length);return n=i.indexOf("!"),n!==-1&&(t=i.substring(n+1,i.length),t=t==="strip",i=i.substring(0,n)),{moduleName:r,ext:i,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,c.isBuild&&(l[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}c.isBuild=i.isBuild;var s=t.parseName(e),l=s.moduleName+"."+s.ext,h=n.toUrl(l),p=c.useXhr||t.useXhr;!o||p(h,u,a,f)?t.get(h,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([l],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(l.hasOwnProperty(n)){var s=t.jsEscape(l[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.moduleName+"."+o.ext,a=r.toUrl(o.moduleName+"."+o.ext)+".js";t.load(u,r,function(n){var r=function(e){return i(a,e)};r.asModule=function(e,t){return i.asModule(e,a,t)},t.write(e,u,r,s)},s)}};if(c.env==="node"||!c.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("﻿")===0&&(r=r.substring(1)),t(r)};else if(c.env==="xhr"||!c.env&&t.createXhr())t.get=function(e,n,r){var i=t.createXhr();i.open("GET",e,!0),c.onXhr&&c.onXhr(i,e),i.onreadystatechange=function(t){var s,o;i.readyState===4&&(s=i.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=i,r(o)):n(i.responseText))},i.send(null)};else if(c.env==="rhino"||!c.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};return t}),define("text!templates/timeline.html",[],function(){return'<div class="timeline-content">\n    <ul id="time-unit-list">\n    </ul>\n</div>\n'}),define("text!templates/timelineCircle.html",[],function(){return'<li class="time-line circle" id="time-minute-{{index}}">\n    <div class=\'start-circle\' style="border-color: {{color}}">\n        <div class=\'inner-start-circle\' style="background: {{color}}">\n            <div id="start-text">\n                {{ circleText }}\n            </div>\n        </div>\n    </div>\n    <div class="contents-container border-notch">\n        <b class="border-notch notch"></b>\n        <b class="notch"></b>\n        <div class=\'contents\'>\n            {{ text }}\n        </div>\n    </div>\n</li>\n<li class="unit spacer">\n    <div class="line">\n    </div>\n</li>\n'}),define("text!templates/timelineLine.html",[],function(){return'<li class="time-line unit" id="time-minute-{{index}}">\n    <div class="line">\n    </div>\n</li>\n<li class="unit spacer">\n    <div class="line"></div>\n</li>\n'}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("views/recipeTimeline",["backbone","handlebars","models/recipe","text!templates/timeline.html","text!templates/timelineCircle.html","text!templates/timelineLine.html"],function(e,r,i,s,o,u){var a;return a=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.steps=[],i.prototype.num_units=null,i.prototype.timeListId="time-unit-list",i.prototype.stepListId="step-unit-list",i.prototype.start_times=[],i.prototype.end_times=[],i.prototype.el="#rcontainer",i.prototype.scaling=!0,i.prototype.initialize=function(e){return this.timelineTemplate=r.compile(s),this.lineTemplate=r.compile(u),this.circleTemplate=r.compile(o),this.steps=_.sortBy(e,function(e){return parseInt(e.start_time)}),this.num_units=parseInt(_.max(this.steps,function(e){return parseInt(e.end_time)}).end_time),this.start_times=_.map(_.pluck(this.steps,"start_time"),function(e){return parseInt(e)}),this.end_times=_.map(_.pluck(this.steps,"end_time"),function(e){return parseInt(e)}),this.render()},i.prototype.render=function(){return $(this.el).html(this.timelineTemplate),this.buildTimeline()},i.prototype.buildTimeline=function(){var e,t,r,i,s,o;o=[];for(e=i=0,s=this.num_units;0<=s?i<=s:i>=s;e=0<=s?++i:--i)t=_.filter(this.steps,function(t){return parseInt(t.start_time)===e}),r=_.union(this.start_times,{}),n.call(r,e)>=0?o.push($("#"+this.timeListId).append(this.circleTemplate({index:e,circleText:e,color:"#930202",text:_.pluck(t,"description").join(" ")}))):this.scaling?o.push($("#"+this.timeListId).append(this.lineTemplate({index:e}))):o.push(void 0);return o},i}(e.View)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("collections/recipe_ingredients",["backbone","models/recipe_ingredient"],function(e,n){var r;return r=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.model=n,r}(e.Collection)})}.call(this),define("text!templates/recipeIngredients.html",[],function(){return'<div id="ingredient-container">\n    <div class="ingredient-contents">\n        <h3>Ingredients:</h3>\n        <ol id="ingredient-list">\n            {{#each ingredients}}\n                <li data-cid={{ this.cid }}>\n                    {{ this.amount }} {{ this.unit }} <b>{{ this.name }}</b>\n                </li>\n            {{/each}}\n        </ol>\n    </div>\n</div>\n'}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("views/recipeIngredients",["backbone","handlebars","models/recipe","collections/recipe_ingredients","text!templates/recipeIngredients.html"],function(e,n,r,i,s){var o;return o=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.el="#icontainer",r.prototype.initialize=function(e){return e.toJSON!=null?this.ingredients=e:this.ingredients=new i(e),console.log(this.ingredients),this.template=n.compile(s),this.render()},r.prototype.render=function(){return $("#icontainer").html(this.template({ingredients:this.ingredients.toJSON()}))},r}(e.View)})}.call(this),define("text!templates/recipe.html",[],function(){return'<div class="rheader-background"></div>\n<div class="recipe">\n    <div class="haha">\n        <div class="rheader">\n            <div class="one-col">\n                <div class="img-circle"></div>\n            </div>\n            <div class="two-col">\n                <h1 class="title">{{name}}</h1>\n                <h2 class="description">{{description}}</h2>\n                <table>\n                    <tr>\n                        <td class="label">Prep Time</td>\n                        <td class="prep-time">{{prep_time}}</td>\n                    </tr>\n                    <tr>\n                        <td class="label">Cook Time</td>\n                        <td class="cook-time">{{cook_time}}</td>\n                    </tr>\n                    <tr>\n                        <td class="label">Ready In</td>\n                        <td class="ready-in">{{ready_in}}</td>\n                    </tr>\n                </table>\n                <br />\n                <table>\n                    <tr>\n                        <td class="label">Serves</td>\n                        <td class="serving">{{ serving_size }}</td>\n                    </tr>\n                </table>\n            </div>\n        </div>\n    </div>\n    <div id="rcontainer">\n    </div>\n    <div id="icontainer">\n    </div>\n</div>\n'}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("views/recipe",["backbone","handlebars","models/recipe","views/recipeTimeline","views/recipeIngredients","text!templates/recipe.html"],function(e,n,r,i,s,o){var u;return u=function(e){function u(){return u.__super__.constructor.apply(this,arguments)}return t(u,e),u.prototype.steps=[],u.prototype.timelineEl="#rcontainer",u.prototype.initialize=function(e){var t=this;return this.template=n.compile(o),this.model=new r({_id:e.id}),this.model.fetch({success:function(){return t.steps=[],_.each(t.model.attributes.steps,function(e){return t.steps.push(e)}),t.render(),t.renderTimeline(),t.renderIngredients()}})},u.prototype.render=function(){return console.log(this.model),this.$el.html(this.template(this.model.for_template())),$(".img-circle").first().css("background","url('"+this.model.attributes.photo+"')")},u.prototype.renderTimeline=function(){var e;return e=new i(this.steps)},u.prototype.renderIngredients=function(){var e;return e=new s(this.model.get("recipe_ingredients"))},u}(e.View)})}.call(this),function(){define("collections/recipes",["lodash","backbone","models/recipe"],function(e,t,n){var r;return r=t.Collection.extend({url:"/api/recipes#index",model:n,for_template:function(){return e.map(this.models,function(e){return e.for_template()})}})})}.call(this),define("text!templates/recipeList.html",[],function(){return'<div class="rlist-background">\n</div>\n<div class="recipe-list-container">\n    <ul class="recipe-list">\n        {{#each recipes}}\n            <li>\n                <a href="{{this.url}}">\n                    <img src="{{this.photo}}"/>\n                </a>\n                <div class="name-background">\n                    <span class="name-text">\n                        {{this.name}}\n                    </span>\n                </div>\n            </li>\n        {{/each}}\n    </ul>\n</div>\n'}),function(){define("views/recipeList",["jquery","lodash","backbone","handlebars","collections/recipes","text!templates/recipeList.html"],function(e,t,n,r,i,s){var o;return o=n.View.extend({initialize:function(){var e,t=this;return this.collection=new i,this.template=r.compile(s),e=this.collection.fetch({success:function(){return t.render()}})},render:function(){return this.$el.html(this.template({recipes:this.collection.for_template()}))}})})}.call(this),define("text!templates/search.html",[],function(){return'<div class="search-background">\n</div>\n<div id="wrap-push">\n    <div id="search-box-container">\n        <h1>Start a new recipe search: </h1>\n        <form id="search-form" method="GET" action="/api/search">\n            <input type="text" id="search-input" name="q" placeholder="eg. Spaghetti, Soup" value=\'{{query}}\'>\n            <input type="submit" value="Search">\n        </form>\n    </div>\n</div>\n'}),define("text!templates/search_result_container.html",[],function(){return'<div id="results-container" style="overflow: hidden">\n    <h3 style="line-height: 1.0em"><i>Results for <span id="q-ind">query</span></i>: </h3>\n    <ul id="results-list">\n    </ul>\n</div>\n'}),define("text!templates/search_result.html",[],function(){return'<a href="/recipes/{{_id}}" style="color:white">\n<li class="result" style="margin-bottom:20px; overflow: hidden">\n    <div id="result-img-container" style="float: left">\n        <img src="{{ photo }}" width=120px height=120px style="border: 5px solid white; box-shadow: 0 0 4px #000" />\n    </div>\n    <div id="text-content" style="float: left; margin-left: 20px; width: 400px;padding: 15px">\n        <h3 style="margin: 0">{{ name }}</h3>\n        <p>{{ description }}</p>\n    </div>\n</li>\n</a>\n'}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("views/search",["backbone","handlebars","text!templates/search.html","text!templates/search_result_container.html","text!templates/search_result.html"],function(e,n,r,i,s){var o;return o=function(e){function o(){return o.__super__.constructor.apply(this,arguments)}return t(o,e),o.prototype.query="",o.prototype.events={"submit #search-form":"doSearch"},o.prototype.initialize=function(e){return this.template=n.compile(r),this.resContainerTemplate=n.compile(i),this.searchResultHtml=n.compile(s),this.query=e,this.render(),!1},o.prototype.render=function(){return this.$el.html(this.template({query:this.query})),this.doSearch()},o.prototype.renderResults=function(e){var t=this;return _.isEmpty($("#results-container"))&&$("#wrap-push").append(this.resContainerTemplate),$("#results-list").html(""),_.each(e,function(e){return e.description=e.description.substring(0,150)+"...",$("#results-list").append(t.searchResultHtml(e))})},o.prototype.doSearch=function(e){var t,n,r=this;e!=null&&(e.preventDefault(),this.query=$("input[name=q]").val(),window.router.navigate("recipes/search/"+this.query));if(!_.isEmpty(this.query))return t="/api/recipes/search.json",n=""+t+"?q="+this.query,$.getJSON(n,function(e){return r.renderResults(e),r.updateQueryIndicator(r.query)}),!1},o.prototype.updateQueryIndicator=function(e){return $("span#q-ind").text(e)},o}(e.View)})}.call(this),function(){define("collections/steps",["lodash","backbone","models/step"],function(e,t,n){var r;return r=t.Collection.extend({model:n})})}.call(this),define("text!templates/createRecipe.html",[],function(){return'<div class="rheader-background"></div>\n<div class="recipe">\n    <div class="haha">\n        <div class="rheader">\n            <div class="one-col">\n                <div class="img-circle editable" id="recipe-photo" data-edit="text" data-field="photo"></div>\n            </div>\n            <div class="two-col">\n                <h1 class="title editable" id="recipe-name" data-edit="text" data-field="name">{{name}}</h1>\n                <h2 class="description editable" id="recipe-description" data-edit="textarea" data-field="description">{{description}}</h2>\n                <table>\n                    <tr id="recipe-preptime">\n                        <td class="label">Prep Time</td>\n                        <td class="prep-time editable" data-edit="text" data-field="prep_time">{{prep_time}}</td>\n                    </tr>\n                    <tr id="recipe-cooktime">\n                        <td class="label">Cook Time</td>\n                        <td class="cook-time editable" data-edit="text" data-field="cook_time">{{cook_time}}</td>\n                    </tr>\n                    <tr id="recipe-readyin">\n                        <td class="label">Ready In</td>\n                        <td class="ready-in editable" data-edit="text" data-field="ready_in">{{ready_in}}</td>\n                    </tr>\n                </table>\n                <br />\n                <table>\n                    <tr id="recipe-servingsize">\n                        <td class="label">Serves</td>\n                        <td class="serving editable" data-edit="text" data-field="serving_size">{{ serving_size }}</td>\n                    </tr>\n                </table>\n            </div>\n        </div>\n    </div>\n    <div id="rcontainer">\n    </div>\n    <div id="icontainer">\n    </div>\n</div>\n'}),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};define("views/createRecipe",["backbone","handlebars","lodash","jquery","jquery.simplemodal","models/recipe","models/recipe_ingredient","models/step","collections/steps","collections/recipe_ingredients","views/recipeTimeline","views/recipeIngredients","text!templates/createRecipe.html"],function(Backbone,Handlebars,_,$,simplemodal,Recipe,RecipeIngredient,Step,StepList,RecipeIngredients,Timeline,IngredientList,createRecipeTemplate){var CreateRecipeView;return CreateRecipeView=function(_super){function CreateRecipeView(){return CreateRecipeView.__super__.constructor.apply(this,arguments)}return __extends(CreateRecipeView,_super),CreateRecipeView.prototype.events={"dblclick .editable":"edit","mouseover .editable":"highlight","mouseout .editable":"unhighlight","click #new-ingredient":"createIngredient","mouseover .contents-container .contents":"highlight","mouseout .contents-container .contents":"unhighlight","dblclick .contents-container .contents":"editStep","click .unit":"addStep"},CreateRecipeView.prototype.initialize=function(params){return this.template=Handlebars.compile(createRecipeTemplate),this.model=new Recipe({name:"Double click here to edit the recipe name.",photo:"http://freecoloringpagesite.com/coloring-pics/blue-coloring-2.png",description:"Double click here to edit the recipe description. Additionally, you can double click any thing on this recipe to edit it.",prep_time:"0",cook_time:"0",ready_in:"0",serving_size:"0",recipe_ingredients:new RecipeIngredients,steps:new StepList([new Step({description:"Click here to edit this step.",start_time:0,end_time:30})])})},CreateRecipeView.prototype.render=function(){var _this=this;return this.$el.html(this.template(this.model.for_template())),$(".recipe").ready(function(){return $(".img-circle").first().css("background","url('"+_this.model.attributes.photo+"')"),_this.renderIngredients(),_this.renderTimeline(),_this.renderFormActions()})},CreateRecipeView.prototype.renderFormActions=function(){var _this=this;return $("section.container").prepend("<div id='form-actions'>          <a href='#' id='submit-create-recipe'>Save Recipe</a>        </div>"),$("#submit-create-recipe").ready(function(){return $("#submit-create-recipe").on("click",function(e){return e.preventDefault(),_this.saveRecipe(),!1})})},CreateRecipeView.prototype.renderIngredients=function(){var _this=this;return this.ingredientsList=new IngredientList(this.model.get("recipe_ingredients")),console.log(this.ingredientsList),$(".ingredient-contents").ready(function(){return $("#ingredient-list li").addClass("editable"),$("#ingredient-list li").addClass("ingredient"),$("#ingredient-list").append("<li style='list-style-type: none;'>                                      <a href='#' id='new-ingredient'>                                      + Add Ingredient</a></li>")})},CreateRecipeView.prototype.renderTimeline=function(){var steps;return steps=this.model.get("steps").toJSON(),this.timeline=new Timeline(steps)},CreateRecipeView.prototype.highlight=function(e){return $(e.target).hasClass("img-circle")?$(e.target).css("border-color","#ffff99"):$(e.target).css("background","#ffff99"),$(e.target).css("color","#478dff")},CreateRecipeView.prototype.unhighlight=function(e){return $(e.target).hasClass("img-circle")?$(e.target).css("border-color","#fff"):$(e.target).css("background","none"),$(e.target).css("color","black")},CreateRecipeView.prototype.edit=function(e){var field,html,text,type,_this=this;return e.preventDefault(),type=$(e.target).attr("data-edit"),field=$(e.target).attr("data-field"),html="<form id='edit-recipe-field-form'>",text=this.model.get(field),type==="textarea"?html+="<textarea name='edit' rows=6 cols=60>"+text+"</textarea>                  <br /><br/><input type='submit' class='submit-button'>":html+="<input type='text' name='edit' value='"+text+"' size=60/>                  <br /><br /><input type='submit' class='submit-button'>",html+="</form>",$.modal(html,{onShow:function(dialog){return $("#edit-recipe-field-form").on("submit",function(e){return e.preventDefault(),_this.model.set(field,$("input[name=edit], textarea[name=edit]").val()),$.modal.close(),_this.render(),!1})}})},CreateRecipeView.prototype.createIngredient=function(e){var html,_this=this;return e.preventDefault(),html="<form id='create-ingredient-form'>                  <p><input type='text' name='amount' placeholder='Amount'/></p>                  <p><input type='text' name='unit' placeholder='Unit'/></p>                  <p><input type='text' name='name' placeholder='Name'/></p>                  <input type='submit'>                </form>",$.modal(html,{onShow:function(dialog){return $("#create-ingredient-form").on("submit",function(e){var amount,ings,name,rIng,unit;return e.preventDefault(),ings=_this.model.get("recipe_ingredients"),amount=$("input[name=amount]").val(),unit=$("input[name=unit]").val(),name=$("input[name=name]").val(),rIng=new RecipeIngredient({amount:amount,unit:unit,name:name}),rIng.set("cid",rIng.cid),ings.push(rIng),_this.model.set("recipe_ingredients",ings),$.modal.close(),_this.renderIngredients(),!1})}}),!1},CreateRecipeView.prototype.editIngredient=function(e){var html;return e.preventDefault(),html="<form id='create-ingredient-form'>                  <p><input type='text' name='amount' placeholder='Amount'/></p>                  <p><input type='text' name='unit' placeholder='Unit'/></p>                  <p><input type='text' name='name' placeholder='Name'/></p>                  <input type='submit'>                </form>"},CreateRecipeView.prototype.editStep=function(e){var html,text,_this=this;return e.preventDefault(),text=$(e.target).text().trim(),html="<form id='edit-step-form'>                  <textarea name='step' rows=5 cols=40>"+text+"</textarea>                  <br />                  <br />                  <input type='submit'>                </form>",$.modal(html,{onShow:function(dialog){return $("#edit-step-form").on("submit",function(e){var new_text,step,steps;return e.preventDefault(),steps=_this.model.get("steps"),step=steps.where({description:text})[0],new_text=$("textarea[name='step']").val(),step.set("description",new_text),$.modal.close(),_this.renderTimeline()})}})},CreateRecipeView.prototype.addStep=function(e){var html,_this=this;return e.preventDefault(),html="<form id='add-step-form'>                  <textarea name='description' rows=5 cols=40></textarea>                  <br />                  <p>                  <input type='text' name='start_time' placeholder='Start time'/><br />                  <input type='text' name='end_time' placeholder='End time'/><br />                  </p>                  <br />                  <input type='submit'>                </form>",$.modal(html,{onShow:function(dialog){return $("#add-step-form").on("submit",function(e){var description,end_time,start_time,steps;return e.preventDefault(),description=$("textarea[name=description]").val(),start_time=$("input[name=start_time]").val(),end_time=$("input[name=end_time]").val(),steps=_this.model.get("steps"),steps.push(new Step({description:description,start_time:start_time,end_time:end_time})),_this.model.set("steps",steps),$.modal.close(),_this.renderTimeline()})}})},CreateRecipeView.prototype.saveRecipe=function(){return this.model.save()},CreateRecipeView}(Backbone.View)})}.call(this),function(){define("router",["backbone","views/recipe","views/recipeList","views/search","views/createRecipe"],function(e,t,n,r,i){var s,o;return s=e.Router.extend({routes:{"":"index","recipes/search/:q":"index",recipes:"showRecipes","recipes/create":"createRecipe","recipes/:id":"showRecipe"},start:function(){return e.history.start({pushState:!0})},index:function(e){var t;return e!=null?t=new r(e):t=new r,$("section.container").html(t.el)},showRecipe:function(e){var n;return n=new t({id:e}),$("section.container").html(n.el)},showRecipes:function(){var e;return e=new n,$("section.container").html(e.el)},createRecipe:function(){var e;return e=new i,$("section.container").html(e.el),e.render()}}),o=function(){return window.router=new s,window.router.start()},{initialize:o}})}.call(this),function(){define("application",["jquery","jquery.simplemodal","lodash","backbone","handlebars","router"],function($,simplemodal,_,Backbone,Handlebars,Router){var initialize,setModalDefaults;return initialize=function(){return setModalDefaults(),Backbone.emulateHTTP=!0,Router.initialize()},setModalDefaults=function(){return $.modal.defaults.closeClass="modalClose",$.modal.defaults.overlayClose=!0},{initialize:initialize,root:"/"}})}.call(this),function(){require(["application","backbone"],function(e){return e.initialize(),$(document).on("click","a:not([data-bypass])",function(t){var n,r;n={prop:$(this).prop("href"),attr:$(this).attr("href")},r=""+location.protocol+"//"+location.host+e.root;if(n.prop&&n.prop.slice(0,r.length)===r)return t.preventDefault(),Backbone.history.navigate(n.attr,!0)})})}.call(this),define("main",function(){})