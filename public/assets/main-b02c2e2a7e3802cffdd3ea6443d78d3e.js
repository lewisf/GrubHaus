/*
 * SimpleModal @VERSION - jQuery Plugin
 * http://simplemodal.com/
 * Copyright (c) 2012 Eric Martin
 * Licensed under MIT and GPL
 * Date:
 */

/**
 * @license RequireJS text 2.0.3 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

(function(factory){typeof define=="function"&&define.amd?define("simplemodal",["jquery"],factory):factory(jQuery)})(function($){var d=[],doc=$(document),ie6=$.browser.msie&&parseInt($.browser.version)===6&&typeof window.XMLHttpRequest!="object",ie7=$.browser.msie&&parseInt($.browser.version)===7,ieQuirks=null,wndw=$(window),w=[];$.modal=function(data,options){return $.modal.impl.init(data,options)},$.modal.close=function(){$.modal.impl.close()},$.modal.focus=function(pos){$.modal.impl.focus(pos)},$.modal.setContainerDimensions=function(){$.modal.impl.setContainerDimensions()},$.modal.setPosition=function(){$.modal.impl.setPosition()},$.modal.update=function(height,width){$.modal.impl.update(height,width)},$.fn.modal=function(options){return $.modal.impl.init(this,options)},$.modal.defaults={appendTo:"body",focus:!0,opacity:50,overlayId:"simplemodal-overlay",overlayCss:{},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!1,autoPosition:!0,zIndex:1e3,close:!0,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"simplemodal-close",escClose:!0,overlayClose:!1,fixed:!0,position:null,persist:!1,modal:!0,onOpen:null,onShow:null,onClose:null},$.modal.impl={d:{},init:function(data,options){var s=this;if(s.d.data)return!1;ieQuirks=$.browser.msie&&!$.support.boxModel,s.o=$.extend({},$.modal.defaults,options),s.zIndex=s.o.zIndex,s.occb=!1;if(typeof data=="object")data=data instanceof $?data:$(data),s.d.placeholder=!1,data.parent().parent().size()>0&&(data.before($("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"})),s.d.placeholder=!0,s.display=data.css("display"),s.o.persist||(s.d.orig=data.clone(!0)));else{if(typeof data!="string"&&typeof data!="number")return alert("SimpleModal Error: Unsupported data type: "+typeof data),s;data=$("<div></div>").html(data)}return s.create(data),data=null,s.open(),$.isFunction(s.o.onShow)&&s.o.onShow.apply(s,[s.d]),s},create:function(data){var s=this;s.getDimensions(),s.o.modal&&ie6&&(s.d.iframe=$('<iframe src="javascript:false;"></iframe>').css($.extend(s.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:w[0],width:w[1],zIndex:s.o.zIndex,top:0,left:0})).appendTo(s.o.appendTo)),s.d.overlay=$("<div></div>").attr("id",s.o.overlayId).addClass("simplemodal-overlay").css($.extend(s.o.overlayCss,{display:"none",opacity:s.o.opacity/100,height:s.o.modal?d[0]:0,width:s.o.modal?d[1]:0,position:"fixed",left:0,top:0,zIndex:s.o.zIndex+1})).appendTo(s.o.appendTo),s.d.container=$("<div></div>").attr("id",s.o.containerId).addClass("simplemodal-container").css($.extend({position:s.o.fixed?"fixed":"absolute"},s.o.containerCss,{display:"none",zIndex:s.o.zIndex+2})).append(s.o.close&&s.o.closeHTML?$(s.o.closeHTML).addClass(s.o.closeClass):"").appendTo(s.o.appendTo),s.d.wrap=$("<div></div>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(s.d.container),s.d.data=data.attr("id",data.attr("id")||s.o.dataId).addClass("simplemodal-data").css($.extend(s.o.dataCss,{display:"none"})).appendTo("body"),data=null,s.setContainerDimensions(),s.d.data.appendTo(s.d.wrap),(ie6||ieQuirks)&&s.fixIE()},bindEvents:function(){var s=this;$("."+s.o.closeClass).bind("click.simplemodal",function(e){e.preventDefault(),s.close()}),s.o.modal&&s.o.close&&s.o.overlayClose&&s.d.overlay.bind("click.simplemodal",function(e){e.preventDefault(),s.close()}),doc.bind("keydown.simplemodal",function(e){s.o.modal&&e.keyCode===9?s.watchTab(e):s.o.close&&s.o.escClose&&e.keyCode===27&&(e.preventDefault(),s.close())}),wndw.bind("resize.simplemodal orientationchange.simplemodal",function(){s.getDimensions(),s.o.autoResize?s.setContainerDimensions():s.o.autoPosition&&s.setPosition(),ie6||ieQuirks?s.fixIE():s.o.modal&&(s.d.iframe&&s.d.iframe.css({height:w[0],width:w[1]}),s.d.overlay.css({height:d[0],width:d[1]}))})},unbindEvents:function(){$("."+this.o.closeClass).unbind("click.simplemodal"),doc.unbind("keydown.simplemodal"),wndw.unbind(".simplemodal"),this.d.overlay.unbind("click.simplemodal")},fixIE:function(){var s=this,p=s.o.position;$.each([s.d.iframe||null,s.o.modal?s.d.overlay:null,s.d.container.css("position")==="fixed"?s.d.container:null],function(i,el){if(el){var bch="document.body.clientHeight",bcw="document.body.clientWidth",bsh="document.body.scrollHeight",bsl="document.body.scrollLeft",bst="document.body.scrollTop",bsw="document.body.scrollWidth",ch="document.documentElement.clientHeight",cw="document.documentElement.clientWidth",sl="document.documentElement.scrollLeft",st="document.documentElement.scrollTop",s=el[0].style;s.position="absolute";if(i<2)s.removeExpression("height"),s.removeExpression("width"),s.setExpression("height",""+bsh+" > "+bch+" ? "+bsh+" : "+bch+' + "px"'),s.setExpression("width",""+bsw+" > "+bcw+" ? "+bsw+" : "+bcw+' + "px"');else{var te,le;if(p&&p.constructor===Array){var top=p[0]?typeof p[0]=="number"?p[0].toString():p[0].replace(/px/,""):el.css("top").replace(/px/,"");te=top.indexOf("%")===-1?top+" + (t = "+st+" ? "+st+" : "+bst+') + "px"':parseInt(top.replace(/%/,""))+" * (("+ch+" || "+bch+") / 100) + (t = "+st+" ? "+st+" : "+bst+') + "px"';if(p[1]){var left=typeof p[1]=="number"?p[1].toString():p[1].replace(/px/,"");le=left.indexOf("%")===-1?left+" + (t = "+sl+" ? "+sl+" : "+bsl+') + "px"':parseInt(left.replace(/%/,""))+" * (("+cw+" || "+bcw+") / 100) + (t = "+sl+" ? "+sl+" : "+bsl+') + "px"'}}else te="("+ch+" || "+bch+") / 2 - (this.offsetHeight / 2) + (t = "+st+" ? "+st+" : "+bst+') + "px"',le="("+cw+" || "+bcw+") / 2 - (this.offsetWidth / 2) + (t = "+sl+" ? "+sl+" : "+bsl+') + "px"';s.removeExpression("top"),s.removeExpression("left"),s.setExpression("top",te),s.setExpression("left",le)}}})},focus:function(pos){var s=this,p=pos&&$.inArray(pos,["first","last"])!==-1?pos:"first",input=$(":input:enabled:visible:"+p,s.d.wrap);setTimeout(function(){input.length>0?input.focus():s.d.wrap.focus()},10)},getDimensions:function(){var s=this,h=typeof window.innerHeight=="undefined"?wndw.height():window.innerHeight;d=[doc.height(),doc.width()],w=[h,wndw.width()]},getVal:function(v,d){return v?typeof v=="number"?v:v==="auto"?0:v.indexOf("%")>0?parseInt(v.replace(/%/,""))/100*(d==="h"?w[0]:w[1]):parseInt(v.replace(/px/,"")):null},update:function(height,width){var s=this;if(!s.d.data)return!1;s.d.origHeight=s.getVal(height,"h"),s.d.origWidth=s.getVal(width,"w"),s.d.data.hide(),height&&s.d.container.css("height",height),width&&s.d.container.css("width",width),s.setContainerDimensions(),s.d.data.show(),s.o.focus&&s.focus(),s.unbindEvents(),s.bindEvents()},setContainerDimensions:function(){var s=this,badIE=ie6||ie7,ch=s.d.origHeight?s.d.origHeight:$.browser.opera?s.d.container.height():s.getVal(badIE?s.d.container[0].currentStyle.height:s.d.container.css("height"),"h"),cw=s.d.origWidth?s.d.origWidth:$.browser.opera?s.d.container.width():s.getVal(badIE?s.d.container[0].currentStyle.width:s.d.container.css("width"),"w"),dh=s.d.data.outerHeight(!0),dw=s.d.data.outerWidth(!0);s.d.origHeight=s.d.origHeight||ch,s.d.origWidth=s.d.origWidth||cw;var mxoh=s.o.maxHeight?s.getVal(s.o.maxHeight,"h"):null,mxow=s.o.maxWidth?s.getVal(s.o.maxWidth,"w"):null,mh=mxoh&&mxoh<w[0]?mxoh:w[0],mw=mxow&&mxow<w[1]?mxow:w[1],moh=s.o.minHeight?s.getVal(s.o.minHeight,"h"):"auto";ch?ch=s.o.autoResize&&ch>mh?mh:ch<moh?moh:ch:dh?dh>mh?ch=mh:s.o.minHeight&&moh!=="auto"&&dh<moh?ch=moh:ch=dh:ch=moh;var mow=s.o.minWidth?s.getVal(s.o.minWidth,"w"):"auto";cw?cw=s.o.autoResize&&cw>mw?mw:cw<mow?mow:cw:dw?dw>mw?cw=mw:s.o.minWidth&&mow!=="auto"&&dw<mow?cw=mow:cw=dw:cw=mow,s.d.container.css({height:ch,width:cw}),s.d.wrap.css({overflow:dh>ch||dw>cw?"auto":"visible"}),s.o.autoPosition&&s.setPosition()},setPosition:function(){var s=this,top,left,hc=w[0]/2-s.d.container.outerHeight(!0)/2,vc=w[1]/2-s.d.container.outerWidth(!0)/2,st=s.d.container.css("position")!=="fixed"?wndw.scrollTop():0;s.o.position&&Object.prototype.toString.call(s.o.position)==="[object Array]"?(top=st+(s.o.position[0]||hc),left=s.o.position[1]||vc):(top=st+hc,left=vc),s.d.container.css({left:left,top:top})},watchTab:function(e){var s=this;if($(e.target).parents(".simplemodal-container").length>0){s.inputs=$(":input:enabled:visible:first, :input:enabled:visible:last",s.d.data[0]);if(!e.shiftKey&&e.target===s.inputs[s.inputs.length-1]||e.shiftKey&&e.target===s.inputs[0]||s.inputs.length===0){e.preventDefault();var pos=e.shiftKey?"last":"first";s.focus(pos)}}else e.preventDefault(),s.focus()},open:function(){var s=this;s.d.iframe&&s.d.iframe.show(),$.isFunction(s.o.onOpen)?s.o.onOpen.apply(s,[s.d]):(s.d.overlay.show(),s.d.container.show(),s.d.data.show()),s.o.focus&&s.focus(),s.bindEvents()},close:function(){var s=this;if(!s.d.data)return!1;s.unbindEvents();if($.isFunction(s.o.onClose)&&!s.occb)s.occb=!0,s.o.onClose.apply(s,[s.d]);else{if(s.d.placeholder){var ph=$("#simplemodal-placeholder");s.o.persist?ph.replaceWith(s.d.data.removeClass("simplemodal-data").css("display",s.display)):(s.d.data.hide().remove(),ph.replaceWith(s.d.orig))}else s.d.data.hide().remove();s.d.container.hide().remove(),s.d.overlay.hide(),s.d.iframe&&s.d.iframe.hide().remove(),s.d.overlay.remove(),s.d={}}}}}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("models/recipe_ingredient",["backbone"],function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.idAttribute="_id",n.prototype.schema={amount:"Text",unit:"Text",name:"Text"},n}(e.Model)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("models/step",["backbone"],function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.idAttribute="_id",n.prototype.schema={description:"Text",start_time:"Text",end_time:"Text"},n}(e.Model)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("models/recipe",["backbone","models/recipe_ingredient","models/step"],function(e,n,r){var i;return i=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.idAttribute="_id",i.prototype.urlRoot="/api/recipes",i.prototype.schema={name:"Text",photo:"Text",description:"Text","Prep time":"Text","Cook time":"Text","Ready In":"Text",serving_size:"Text","Recipe Ingredients":{type:"NestedModel",model:n},steps:{type:"NestedModel",model:r}},i.prototype.permalink=function(){return"recipes/"+this.id},i.prototype.initialize=function(){},i.prototype.for_template=function(){var e;return e=this.toJSON(),e.url=this.permalink(),e},i}(e.Model)})}.call(this),define("text",["module"],function(module){var text,fs,progIds=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],xmlRegExp=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,bodyRegExp=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,hasLocation=typeof location!="undefined"&&location.href,defaultProtocol=hasLocation&&location.protocol&&location.protocol.replace(/\:/,""),defaultHostName=hasLocation&&location.hostname,defaultPort=hasLocation&&(location.port||undefined),buildMap=[],masterConfig=module.config&&module.config()||{};text={version:"2.0.3",strip:function(content){if(content){content=content.replace(xmlRegExp,"");var matches=content.match(bodyRegExp);matches&&(content=matches[1])}else content="";return content},jsEscape:function(content){return content.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:masterConfig.createXhr||function(){var xhr,i,progId;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(i=0;i<3;i+=1){progId=progIds[i];try{xhr=new ActiveXObject(progId)}catch(e){}if(xhr){progIds=[progId];break}}return xhr},parseName:function(name){var strip=!1,index=name.indexOf("."),modName=name.substring(0,index),ext=name.substring(index+1,name.length);return index=ext.indexOf("!"),index!==-1&&(strip=ext.substring(index+1,ext.length),strip=strip==="strip",ext=ext.substring(0,index)),{moduleName:modName,ext:ext,strip:strip}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(url,protocol,hostname,port){var uProtocol,uHostName,uPort,match=text.xdRegExp.exec(url);return match?(uProtocol=match[2],uHostName=match[3],uHostName=uHostName.split(":"),uPort=uHostName[1],uHostName=uHostName[0],(!uProtocol||uProtocol===protocol)&&(!uHostName||uHostName.toLowerCase()===hostname.toLowerCase())&&(!uPort&&!uHostName||uPort===port)):!0},finishLoad:function(name,strip,content,onLoad){content=strip?text.strip(content):content,masterConfig.isBuild&&(buildMap[name]=content),onLoad(content)},load:function(name,req,onLoad,config){if(config.isBuild&&!config.inlineText){onLoad();return}masterConfig.isBuild=config.isBuild;var parsed=text.parseName(name),nonStripName=parsed.moduleName+"."+parsed.ext,url=req.toUrl(nonStripName),useXhr=masterConfig.useXhr||text.useXhr;!hasLocation||useXhr(url,defaultProtocol,defaultHostName,defaultPort)?text.get(url,function(content){text.finishLoad(name,parsed.strip,content,onLoad)},function(err){onLoad.error&&onLoad.error(err)}):req([nonStripName],function(content){text.finishLoad(parsed.moduleName+"."+parsed.ext,parsed.strip,content,onLoad)})},write:function(pluginName,moduleName,write,config){if(buildMap.hasOwnProperty(moduleName)){var content=text.jsEscape(buildMap[moduleName]);write.asModule(pluginName+"!"+moduleName,"define(function () { return '"+content+"';});\n")}},writeFile:function(pluginName,moduleName,req,write,config){var parsed=text.parseName(moduleName),nonStripName=parsed.moduleName+"."+parsed.ext,fileName=req.toUrl(parsed.moduleName+"."+parsed.ext)+".js";text.load(nonStripName,req,function(value){var textWrite=function(contents){return write(fileName,contents)};textWrite.asModule=function(moduleName,contents){return write.asModule(moduleName,fileName,contents)},text.write(pluginName,nonStripName,textWrite,config)},config)}};if(masterConfig.env==="node"||!masterConfig.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)fs=require.nodeRequire("fs"),text.get=function(url,callback){var file=fs.readFileSync(url,"utf8");file.indexOf("﻿")===0&&(file=file.substring(1)),callback(file)};else if(masterConfig.env==="xhr"||!masterConfig.env&&text.createXhr())text.get=function(url,callback,errback){var xhr=text.createXhr();xhr.open("GET",url,!0),masterConfig.onXhr&&masterConfig.onXhr(xhr,url),xhr.onreadystatechange=function(evt){var status,err;xhr.readyState===4&&(status=xhr.status,status>399&&status<600?(err=new Error(url+" HTTP status: "+status),err.xhr=xhr,errback(err)):callback(xhr.responseText))},xhr.send(null)};else if(masterConfig.env==="rhino"||!masterConfig.env&&typeof Packages!="undefined"&&typeof java!="undefined")text.get=function(url,callback){var stringBuffer,line,encoding="utf-8",file=new java.io.File(url),lineSeparator=java.lang.System.getProperty("line.separator"),input=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(file),encoding)),content="";try{stringBuffer=new java.lang.StringBuffer,line=input.readLine(),line&&line.length()&&line.charAt(0)===65279&&(line=line.substring(1)),stringBuffer.append(line);while((line=input.readLine())!==null)stringBuffer.append(lineSeparator),stringBuffer.append(line);content=String(stringBuffer.toString())}finally{input.close()}callback(content)};return text}),define("text!templates/timeline.html",[],function(){return'<div class="timeline-content">\n    <ul id="time-unit-list">\n    </ul>\n</div>\n'}),define("text!templates/timelineCircle.html",[],function(){return'<li class="time-line circle" id="time-minute-{{index}}">\n    <div class=\'start-circle\' style="border-color: {{color}}">\n        <div class=\'inner-start-circle\' style="background: {{color}}">\n            <div id="start-text">\n                {{ circleText }}\n            </div>\n        </div>\n    </div>\n    <div class="contents-container border-notch">\n        <b class="border-notch notch"></b>\n        <b class="notch"></b>\n        <div class=\'contents\'>\n            {{ text }}\n        </div>\n    </div>\n</li>\n<li class="unit spacer">\n    <div class="line">\n    </div>\n</li>\n'}),define("text!templates/timelineLine.html",[],function(){return'<li class="time-line unit" id="time-minute-{{index}}">\n    <div class="line">\n    </div>\n</li>\n<li class="unit spacer">\n    <div class="line"></div>\n</li>\n'}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define("views/recipeTimeline",["backbone","handlebars","models/recipe","text!templates/timeline.html","text!templates/timelineCircle.html","text!templates/timelineLine.html"],function(e,r,i,s,o,u){var a;return a=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.steps=[],i.prototype.num_units=null,i.prototype.timeListId="time-unit-list",i.prototype.stepListId="step-unit-list",i.prototype.start_times=[],i.prototype.end_times=[],i.prototype.el="#rcontainer",i.prototype.scaling=!0,i.prototype.initialize=function(e){return this.timelineTemplate=r.compile(s),this.lineTemplate=r.compile(u),this.circleTemplate=r.compile(o),this.steps=_.sortBy(e,function(e){return parseInt(e.start_time)}),this.num_units=parseInt(_.max(this.steps,function(e){return parseInt(e.end_time)}).end_time),this.start_times=_.map(_.pluck(this.steps,"start_time"),function(e){return parseInt(e)}),this.end_times=_.map(_.pluck(this.steps,"end_time"),function(e){return parseInt(e)}),this.render()},i.prototype.render=function(){return $(this.el).html(this.timelineTemplate),this.buildTimeline()},i.prototype.buildTimeline=function(){var e,t,r,i,s,o;o=[];for(e=i=0,s=this.num_units;0<=s?i<=s:i>=s;e=0<=s?++i:--i)t=_.filter(this.steps,function(t){return parseInt(t.start_time)===e}),r=_.union(this.start_times,{}),n.call(r,e)>=0?o.push($("#"+this.timeListId).append(this.circleTemplate({index:e,circleText:e,color:"#930202",text:_.pluck(t,"description").join(" ")}))):this.scaling?o.push($("#"+this.timeListId).append(this.lineTemplate({index:e}))):o.push(void 0);return o},i}(e.View)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("collections/recipe_ingredients",["backbone","models/recipe_ingredient"],function(e,n){var r;return r=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.model=n,r}(e.Collection)})}.call(this),define("text!templates/recipeIngredients.html",[],function(){return'<div id="ingredient-container">\n    <div class="ingredient-contents">\n        <h3>Ingredients:</h3>\n        <ol id="ingredient-list">\n            {{#each ingredients}}\n                <li data-cid={{ this.cid }}>\n                    {{ this.amount }} {{ this.unit }} <b>{{ this.name }}</b>\n                </li>\n            {{/each}}\n        </ol>\n    </div>\n</div>\n'}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("views/recipeIngredients",["backbone","handlebars","models/recipe","collections/recipe_ingredients","text!templates/recipeIngredients.html"],function(e,n,r,i,s){var o;return o=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.el="#icontainer",r.prototype.initialize=function(e){return e.toJSON!=null?this.ingredients=e:this.ingredients=new i(e),console.log(this.ingredients),this.template=n.compile(s),this.render()},r.prototype.render=function(){return $("#icontainer").html(this.template({ingredients:this.ingredients.toJSON()}))},r}(e.View)})}.call(this),define("text!templates/recipe.html",[],function(){return'<div class="rheader-background"></div>\n<div class="recipe">\n    <div class="haha">\n        <div class="rheader">\n            <div class="one-col">\n                <div class="img-circle"></div>\n            </div>\n            <div class="two-col">\n                <h1 class="title">{{name}}</h1>\n                <h2 class="description">{{description}}</h2>\n                <table>\n                    <tr>\n                        <td class="label">Prep Time</td>\n                        <td class="prep-time">{{prep_time}}</td>\n                    </tr>\n                    <tr>\n                        <td class="label">Cook Time</td>\n                        <td class="cook-time">{{cook_time}}</td>\n                    </tr>\n                    <tr>\n                        <td class="label">Ready In</td>\n                        <td class="ready-in">{{ready_in}}</td>\n                    </tr>\n                </table>\n                <br />\n                <table>\n                    <tr>\n                        <td class="label">Serves</td>\n                        <td class="serving">{{ serving_size }}</td>\n                    </tr>\n                </table>\n            </div>\n        </div>\n    </div>\n    <div id="rcontainer">\n    </div>\n    <div id="icontainer">\n    </div>\n</div>\n'}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("views/recipe",["backbone","handlebars","models/recipe","views/recipeTimeline","views/recipeIngredients","text!templates/recipe.html"],function(e,n,r,i,s,o){var u;return u=function(e){function u(){return u.__super__.constructor.apply(this,arguments)}return t(u,e),u.prototype.steps=[],u.prototype.timelineEl="#rcontainer",u.prototype.initialize=function(e){var t=this;return this.template=n.compile(o),this.model=new r({_id:e.id}),this.model.fetch({success:function(){return t.steps=[],_.each(t.model.attributes.steps,function(e){return t.steps.push(e)}),t.render(),t.renderTimeline(),t.renderIngredients()}})},u.prototype.render=function(){return console.log(this.model),this.$el.html(this.template(this.model.for_template())),$(".img-circle").first().css("background","url('"+this.model.attributes.photo+"')")},u.prototype.renderTimeline=function(){var e;return e=new i(this.steps)},u.prototype.renderIngredients=function(){var e;return e=new s(this.model.get("recipe_ingredients"))},u}(e.View)})}.call(this),function(){define("collections/recipes",["lodash","backbone","models/recipe"],function(e,t,n){var r;return r=t.Collection.extend({url:"/api/recipes#index",model:n,for_template:function(){return e.map(this.models,function(e){return e.for_template()})}})})}.call(this),define("text!templates/recipeList.html",[],function(){return'<div class="rlist-background">\n</div>\n<div class="recipe-list-container">\n    <ul class="recipe-list">\n        {{#each recipes}}\n            <li>\n                <a href="{{this.url}}">\n                    <img src="{{this.photo}}"/>\n                </a>\n                <div class="name-background">\n                    <span class="name-text">\n                        {{this.name}}\n                    </span>\n                </div>\n            </li>\n        {{/each}}\n    </ul>\n</div>\n'}),function(){define("views/recipeList",["jquery","lodash","backbone","handlebars","collections/recipes","text!templates/recipeList.html"],function(e,t,n,r,i,s){var o;return o=n.View.extend({initialize:function(){var e,t=this;return this.collection=new i,this.template=r.compile(s),e=this.collection.fetch({success:function(){return t.render()}})},render:function(){return this.$el.html(this.template({recipes:this.collection.for_template()}))}})})}.call(this),define("text!templates/search.html",[],function(){return'<div class="search-background">\n</div>\n<div id="wrap-push">\n    <div id="search-box-container">\n        <h1>Start a new recipe search: </h1>\n        <form id="search-form" method="GET" action="/api/search">\n            <input type="text" id="search-input" name="q" placeholder="eg. Spaghetti, Soup" value=\'{{query}}\'>\n            <input type="submit" value="Search">\n        </form>\n    </div>\n</div>\n'}),define("text!templates/search_result_container.html",[],function(){return'<div id="results-container" style="overflow: hidden">\n    <h3 style="line-height: 1.0em"><i>Results for <span id="q-ind">query</span></i>: </h3>\n    <ul id="results-list">\n    </ul>\n</div>\n'}),define("text!templates/search_result.html",[],function(){return'<a href="/recipes/{{_id}}" style="color:white">\n<li class="result" style="margin-bottom:20px; overflow: hidden">\n    <div id="result-img-container" style="float: left">\n        <img src="{{ photo }}" width=120px height=120px style="border: 5px solid white; box-shadow: 0 0 4px #000" />\n    </div>\n    <div id="text-content" style="float: left; margin-left: 20px; width: 400px;padding: 15px">\n        <h3 style="margin: 0">{{ name }}</h3>\n        <p>{{ description }}</p>\n    </div>\n</li>\n</a>\n'}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("views/search",["backbone","handlebars","text!templates/search.html","text!templates/search_result_container.html","text!templates/search_result.html"],function(e,n,r,i,s){var o;return o=function(e){function o(){return o.__super__.constructor.apply(this,arguments)}return t(o,e),o.prototype.query="",o.prototype.events={"submit #search-form":"doSearch"},o.prototype.initialize=function(e){return this.template=n.compile(r),this.resContainerTemplate=n.compile(i),this.searchResultHtml=n.compile(s),this.query=e,this.render(),!1},o.prototype.render=function(){return this.$el.html(this.template({query:this.query})),this.doSearch()},o.prototype.renderResults=function(e){var t=this;return _.isEmpty($("#results-container"))&&$("#wrap-push").append(this.resContainerTemplate),$("#results-list").html(""),_.each(e,function(e){return e.description=e.description.substring(0,150)+"...",$("#results-list").append(t.searchResultHtml(e))})},o.prototype.doSearch=function(e){var t,n,r=this;e!=null&&(e.preventDefault(),this.query=$("input[name=q]").val(),window.router.navigate("recipes/search/"+this.query));if(!_.isEmpty(this.query))return t="/api/recipes/search.json",n=""+t+"?q="+this.query,$.getJSON(n,function(e){return r.renderResults(e),r.updateQueryIndicator(r.query)}),!1},o.prototype.updateQueryIndicator=function(e){return $("span#q-ind").text(e)},o}(e.View)})}.call(this),function(){define("collections/steps",["lodash","backbone","models/step"],function(e,t,n){var r;return r=t.Collection.extend({model:n})})}.call(this),define("text!templates/createRecipe.html",[],function(){return'<div class="rheader-background"></div>\n<div class="recipe">\n    <div class="haha">\n        <div class="rheader">\n            <div class="one-col">\n                <div class="img-circle editable" id="recipe-photo" data-edit="text" data-field="photo"></div>\n            </div>\n            <div class="two-col">\n                <h1 class="title editable" id="recipe-name" data-edit="text" data-field="name">{{name}}</h1>\n                <h2 class="description editable" id="recipe-description" data-edit="textarea" data-field="description">{{description}}</h2>\n                <table>\n                    <tr id="recipe-preptime">\n                        <td class="label">Prep Time</td>\n                        <td class="prep-time editable" data-edit="text" data-field="prep_time">{{prep_time}}</td>\n                    </tr>\n                    <tr id="recipe-cooktime">\n                        <td class="label">Cook Time</td>\n                        <td class="cook-time editable" data-edit="text" data-field="cook_time">{{cook_time}}</td>\n                    </tr>\n                    <tr id="recipe-readyin">\n                        <td class="label">Ready In</td>\n                        <td class="ready-in editable" data-edit="text" data-field="ready_in">{{ready_in}}</td>\n                    </tr>\n                </table>\n                <br />\n                <table>\n                    <tr id="recipe-servingsize">\n                        <td class="label">Serves</td>\n                        <td class="serving editable" data-edit="text" data-field="serving_size">{{ serving_size }}</td>\n                    </tr>\n                </table>\n            </div>\n        </div>\n    </div>\n    <div id="rcontainer">\n    </div>\n    <div id="icontainer">\n    </div>\n</div>\n'}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("views/createRecipe",["backbone","handlebars","lodash","jquery","simplemodal","models/recipe","models/recipe_ingredient","models/step","collections/steps","collections/recipe_ingredients","views/recipeTimeline","views/recipeIngredients","text!templates/createRecipe.html"],function(e,n,r,i,s,o,u,a,f,l,c,h,p){var d;return d=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.events={"mouseover .editable":"highlight","mouseout .editable":"unhighlight","mouseover li.ingredient-editable":"highlight","mouseout li.ingredient-editable":"unhighlight","click #new-ingredient":"createIngredient","dblclick #ingredient-list li.ingredient-editable":"editIngredient","dblclick .editable":"edit","mouseover .contents-container .contents":"highlight","mouseout .contents-container .contents":"unhighlight","dblclick .contents-container .contents":"editStep","click .unit":"addStep"},r.prototype.initialize=function(e){return this.template=n.compile(p),this.model=new o({name:"Double click here to edit the recipe name.",photo:"http://freecoloringpagesite.com/coloring-pics/blue-coloring-2.png",description:"Double click here to edit the recipe description. Additionally, you can double click any thing on this recipe to edit it.",prep_time:"0",cook_time:"0",ready_in:"0",serving_size:"0",recipe_ingredients:new l,steps:new f([new a({description:"Click here to edit this step.",start_time:0,end_time:30})])})},r.prototype.render=function(){var e=this;return this.$el.html(this.template(this.model.for_template())),i(".recipe").ready(function(){return i(".img-circle").first().css("background","url('"+e.model.attributes.photo+"')"),e.renderIngredients(),e.renderTimeline(),e.renderFormActions()})},r.prototype.renderFormActions=function(){var e=this;return i("section.container").prepend("<div id='form-actions'>          <a href='#' id='submit-create-recipe'>Save Recipe</a>        </div>"),i("#submit-create-recipe").ready(function(){return i("#submit-create-recipe").on("click",function(t){return t.preventDefault(),e.saveRecipe(),!1})})},r.prototype.renderIngredients=function(){var e=this;return this.ingredientsList=new h(this.model.get("recipe_ingredients")),console.log(this.ingredientsList),i(".ingredient-contents").ready(function(){return i("#ingredient-list li").addClass("ingredient-editable"),i("#ingredient-list").append("<li style='list-style-type: none;'>                                      <a href='#' id='new-ingredient'>                                      + Add Ingredient</a></li>")})},r.prototype.renderTimeline=function(){var e;return e=this.model.get("steps").toJSON(),this.timeline=new c(e)},r.prototype.highlight=function(e){return i(e.target).hasClass("img-circle")?i(e.target).css("border-color","#ffff99"):i(e.target).css("background","#ffff99"),i(e.target).css("color","#478dff")},r.prototype.unhighlight=function(e){return i(e.target).hasClass("img-circle")?i(e.target).css("border-color","#fff"):i(e.target).css("background","none"),i(e.target).css("color","black")},r.prototype.edit=function(e){var t,n,r,s,o=this;return e.preventDefault(),s=i(e.target).attr("data-edit"),t=i(e.target).attr("data-field"),n="<form id='edit-recipe-field-form'>",r=this.model.get(t),s==="textarea"?n+="<textarea name='edit' rows=6 cols=60>"+r+"</textarea>                  <br /><br/><input type='submit' class='submit-button'>":n+="<input type='text' name='edit' value='"+r+"' size=60/>                  <br /><br /><input type='submit' class='submit-button'>",n+="</form>",i.modal(n,{onShow:function(e){return i("#edit-recipe-field-form").on("submit",function(e){return e.preventDefault(),o.model.set(t,i("input[name=edit], textarea[name=edit]").val()),i.modal.close(),o.render(),!1})}})},r.prototype.editIngredient=function(e){var t,n=this;return e.preventDefault(),t="<form id='edit-ingredient-form'>                  <p><input type='text' name='amount' placeholder='Amount'/></p>                  <p><input type='text' name='unit' placeholder='Unit'/></p>                  <p><input type='text' name='name' placeholder='Name'/></p>                  <input type='submit'>                </form>",i.modal(t,{onShow:function(t){var r,s;return s=n.model.get("recipe_ingredients"),r=s.getByCid(i(e.target).closest(".ingredient-editable").attr("data-cid")),console.log(r),i("input[name=amount]").val(r.get("amount")),i("input[name=unit]").val(r.get("unit")),i("input[name=name]").val(r.get("name")),i("#edit-ingredient-form").on("submit",function(e){return e.preventDefault(),r.set("amount",i("input[name=amount]").val()),r.set("unit",i("input[name=unit]").val()),r.set("name",i("input[name=name]").val()),i.modal.close(),n.renderIngredients(),!1})}})},r.prototype.createIngredient=function(e){var t,n=this;return e.preventDefault(),t="<form id='create-ingredient-form'>                  <p><input type='text' name='amount' placeholder='Amount'/></p>                  <p><input type='text' name='unit' placeholder='Unit'/></p>                  <p><input type='text' name='name' placeholder='Name'/></p>                  <input type='submit'>                </form>",i.modal(t,{onShow:function(e){return i("#create-ingredient-form").on("submit",function(e){var t,r,s,o,a;return e.preventDefault(),r=n.model.get("recipe_ingredients"),t=i("input[name=amount]").val(),a=i("input[name=unit]").val(),s=i("input[name=name]").val(),o=new u({amount:t,unit:a,name:s}),o.set("cid",o.cid),r.push(o),n.model.set("recipe_ingredients",r),i.modal.close(),n.renderIngredients(),!1})}}),!1},r.prototype.editStep=function(e){var t,n,r=this;return e.preventDefault(),n=i(e.target).text().trim(),t="<form id='edit-step-form'>                  <textarea name='step' rows=5 cols=40>"+n+"</textarea>                  <br />                  <br />                  <input type='submit'>                </form>",i.modal(t,{onShow:function(e){return i("#edit-step-form").on("submit",function(e){var t,s,o;return e.preventDefault(),o=r.model.get("steps"),s=o.where({description:n})[0],t=i("textarea[name='step']").val(),s.set("description",t),i.modal.close(),r.renderTimeline()})}})},r.prototype.addStep=function(e){var t,n=this;return e.preventDefault(),t="<form id='add-step-form'>                  <textarea name='description' rows=5 cols=40></textarea>                  <br />                  <p>                  <input type='text' name='start_time' placeholder='Start time'/><br />                  <input type='text' name='end_time' placeholder='End time'/><br />                  </p>                  <br />                  <input type='submit'>                </form>",i.modal(t,{onShow:function(e){return i("#add-step-form").on("submit",function(e){var t,r,s,o;return e.preventDefault(),t=i("textarea[name=description]").val(),s=i("input[name=start_time]").val(),r=i("input[name=end_time]").val(),o=n.model.get("steps"),o.push(new a({description:t,start_time:s,end_time:r})),n.model.set("steps",o),i.modal.close(),n.renderTimeline()})}})},r.prototype.saveRecipe=function(){return this.model.save()},r}(e.View)})}.call(this),function(){define("router",["backbone","views/recipe","views/recipeList","views/search","views/createRecipe"],function(e,t,n,r,i){var s,o;return s=e.Router.extend({routes:{"":"index","recipes/search/:q":"index",recipes:"showRecipes","recipes/create":"createRecipe","recipes/:id":"showRecipe"},start:function(){return e.history.start({pushState:!0})},index:function(e){var t;return e!=null?t=new r(e):t=new r,$("section.container").html(t.el)},showRecipe:function(e){var n;return n=new t({id:e}),$("section.container").html(n.el)},showRecipes:function(){var e;return e=new n,$("section.container").html(e.el)},createRecipe:function(){var e;return e=new i,$("section.container").html(e.el),e.render()}}),o=function(){return window.router=new s,window.router.start()},{initialize:o}})}.call(this),function(){define("app",["jquery","simplemodal","lodash","backbone","handlebars","router"],function(e,t,n,r,i,s){var o,u;return o=function(){return u(),r.emulateHTTP=!0,s.initialize()},u=function(){return e.modal.defaults.closeClass="modalClose",e.modal.defaults.overlayClose=!0},{initialize:o,root:"/"}})}.call(this),function(){require(["app","backbone"],function(e){return e.initialize(),$(document).on("click","a:not([data-bypass])",function(t){var n,r;n={prop:$(this).prop("href"),attr:$(this).attr("href")},r=""+location.protocol+"//"+location.host+e.root;if(n.prop&&n.prop.slice(0,r.length)===r)return t.preventDefault(),Backbone.history.navigate(n.attr,!0)})})}.call(this),define("main",function(){})