(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define(["backbone","handlebars","models/recipe","views/recipeTimeline","views/recipeIngredients","text!templates/recipe.html"],function(e,n,r,i,s,o){var u;return u=function(e){function u(){return u.__super__.constructor.apply(this,arguments)}return t(u,e),u.prototype.steps=[],u.prototype.timelineEl="#rcontainer",u.prototype.events={"click a#favorite-recipe-button":"favorite","click a#unfavorite-recipe-button":"unfavorite","click a#fork-recipe-button":"fork"},u.prototype.initialize=function(e){var t=this;return this.template=n.compile(o),this.model=new r({_id:e.id}),this.model.fetch({success:function(){return t.steps=[],_.each(t.model.get("steps").toJSON(),function(e){return t.steps.push(e)}),t.render(),t.renderTimeline(),t.renderIngredients()}})},u.prototype.render=function(){return this.$el.html(this.template(this.model.for_template())),$(".img-circle").first().css("background","url('"+this.model.attributes.photo+"')")},u.prototype.renderTimeline=function(){var e;return e=new i(this.steps)},u.prototype.renderIngredients=function(){var e;return e=new s(this.model.get("recipe_ingredients"))},u.prototype.favorite=function(e){var t=this;return e.preventDefault(),$.ajax({type:"POST",url:"/api/recipes/favorite/"+this.model.get("_id"),dataType:"json",data:{authenticity_token:$("meta[name='csrf-token']").attr("content")},success:function(){return $("#favorite-recipe-button").text("Unfavorite").attr("id","unfavorite-recipe-button"),t.model.set("is_favorited_by_user?",!0)},error:function(){return alert("Error!")}}),!1},u.prototype.unfavorite=function(e){var t=this;return e.preventDefault(),$.ajax({type:"POST",url:"/api/recipes/unfavorite/"+this.model.get("_id"),dataType:"json",data:{authenticity_token:$("meta[name='csrf-token']").attr("content")},success:function(){return $("#unfavorite-recipe-button").text("Favorite").attr("id","favorite-recipe-button"),t.model.set("is_favorited_by_user?",!1)},error:function(){return alert("Error!")}}),!1},u.prototype.fork=function(e){var t=this;return e.preventDefault(),$.ajax({type:"POST",url:"/api/recipes/fork/"+this.model.get("_id"),dataType:"json",data:{authenticity_token:$("meta[name='csrf-token']").attr("content")},success:function(e){return window.router.navigate("/recipes/edit/"+e._id,{trigger:!0})},error:function(){return alert("Error")}}),!1},u}(e.View)})}).call(this);