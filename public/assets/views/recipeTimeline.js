(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};define(["backbone","handlebars","models/recipe","text!templates/timeline.html","text!templates/timelineCircle.html","text!templates/timelineLine.html"],function(e,r,i,s,o,u){var a;return a=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.steps=[],i.prototype.num_units=null,i.prototype.timeListId="time-unit-list",i.prototype.stepListId="step-unit-list",i.prototype.start_times=[],i.prototype.end_times=[],i.prototype.el="#rcontainer",i.prototype.scaling=!0,i.prototype.initialize=function(e){return this.timelineTemplate=r.compile(s),this.lineTemplate=r.compile(u),this.circleTemplate=r.compile(o),this.steps=_.sortBy(e,function(e){return parseInt(e.start_time)}),this.num_units=parseInt(_.max(this.steps,function(e){return parseInt(e.end_time)}).end_time),this.start_times=_.map(_.pluck(this.steps,"start_time"),function(e){return parseInt(e)}),this.end_times=_.map(_.pluck(this.steps,"end_time"),function(e){return parseInt(e)}),this.render()},i.prototype.render=function(){return $(this.el).html(this.timelineTemplate),this.buildTimeline()},i.prototype.buildTimeline=function(){var e,t,r,i,s,o;o=[];for(e=i=0,s=this.num_units;0<=s?i<=s:i>=s;e=0<=s?++i:--i)t=_.filter(this.steps,function(t){return parseInt(t.start_time)===e}),r=_.union(this.start_times,{}),n.call(r,e)>=0?o.push($("#"+this.timeListId).append(this.circleTemplate({index:e,circleText:e,color:"#930202",text:_.pluck(t,"description").join(" ")}))):this.scaling?o.push($("#"+this.timeListId).append(this.lineTemplate({index:e}))):o.push(void 0);return o},i}(e.View)})}).call(this);